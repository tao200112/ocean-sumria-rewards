(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20613,e=>{"use strict";var s=e.i(43476),t=e.i(71645),l=e.i(65503),a=e.i(64038);let r=({currentView:e,onNavigate:t})=>(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-ocean-900 border-t border-gray-200 dark:border-ocean-800 pb-safe z-50",children:(0,s.jsx)("div",{className:"flex justify-around items-center h-16 max-w-md mx-auto",children:[{id:"home",icon:"home",label:"Home"},{id:"rewards",icon:"local_activity",label:"Rewards"},{id:"profile",icon:"person",label:"Profile"}].map(l=>(0,s.jsxs)("button",{onClick:()=>t(l.id),className:`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${e===l.id?"text-gold-400":"text-gray-400 hover:text-gray-200"}`,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:l.icon}),(0,s.jsx)("span",{className:"text-[10px] font-medium",children:l.label})]},l.id))})}),n=({isSpinning:e,prizes:l,targetPrizeIndex:a,onSpinEnd:r})=>{let[n,i]=(0,t.useState)(0),d=l.filter(e=>e.active),o=360/d.length;return(0,t.useEffect)(()=>{if(e&&null!==a){let e=1800+(360-a*o)-o/2,s=Math.random()*o*.8-.4*o;i(t=>t+e+s);let t=setTimeout(()=>{r()},4e3);return()=>clearTimeout(t)}},[e,a]),(0,s.jsxs)("div",{className:"relative aspect-square max-w-[340px] mx-auto mb-10",children:[(0,s.jsxs)("div",{className:"w-full h-full rounded-full border-[8px] border-ocean-800 bg-ocean-950 relative shadow-[0_0_60px_rgba(0,0,0,0.5)] overflow-hidden",style:{transform:`rotate(${n}deg)`,transition:e?"transform 4s cubic-bezier(0.2, 0.8, 0.2, 1)":"none"},children:[(0,s.jsxs)("div",{className:"absolute inset-0 rounded-full overflow-hidden",children:[d.map((e,t)=>(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full",style:{transform:`rotate(${t*o}deg)`},children:(0,s.jsx)("div",{className:"absolute top-0 left-1/2 w-full h-full origin-left flex items-center justify-center",style:{transform:`rotate(${90-o/2}deg) skewY(-${90-o}deg)`,background:e.color||"#334155"}})},e.id)),(0,s.jsx)("div",{className:"absolute inset-0 rounded-full",style:{background:`conic-gradient(
                            ${d.map((e,s)=>`${e.color||"#334155"} ${s*(360/d.length)}deg ${(s+1)*(360/d.length)}deg`).join(", ")}
                        )`}})]}),d.map((e,t)=>(0,s.jsxs)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-10 h-1/2 origin-bottom flex flex-col justify-start pt-6 items-center z-10",style:{transform:`rotate(${t*o+o/2}deg)`},children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-white drop-shadow-md text-2xl font-bold",children:e.icon}),(0,s.jsx)("span",{className:"text-[10px] font-bold text-white drop-shadow-md max-w-[60px] text-center leading-tight mt-1",children:e.name})]},`icon-${e.id}`))]}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 size-20 rounded-full bg-gradient-to-br from-gold-400 to-amber-600 border-[6px] border-ocean-800 shadow-inner z-20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-ocean-950 text-4xl",children:"stars"})}),(0,s.jsx)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-white z-30 drop-shadow-[0_4px_4px_rgba(0,0,0,0.5)]",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-6xl fill-current text-white",children:"arrow_drop_down"})})]})},i=({spins:e,onBack:a,onSpin:r})=>{let{state:i}=(0,l.useAppStore)(),[d,o]=(0,t.useState)(!1),[c,x]=(0,t.useState)(null),[m,b]=(0,t.useState)(null),[p,u]=(0,t.useState)(!1),h=i.prizes.filter(e=>e.active),g=async()=>{if(e<=0||d)return;let s=await r();if(!s.ok||!s.prize)return void alert(s.error||"Error spinning");let t=h.findIndex(e=>e.id===s.prize?.id);b(s),x(-1!==t?t:0),o(!0)};return(0,s.jsxs)("div",{className:"flex flex-col h-full px-6 pt-6 pb-24 bg-ocean-950",children:[(0,s.jsxs)("button",{onClick:a,disabled:d,className:"flex items-center text-slate-400 mb-6 disabled:opacity-50",children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"arrow_back"})," Back"]}),(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-black text-white mb-2",children:"Game Hub"}),(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gold-400/10 border border-gold-400/20 rounded-full text-gold-400 font-bold text-sm",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-lg",children:"sync"}),"REMAINING SPINS: ",e]})]}),(0,s.jsx)(n,{isSpinning:d,prizes:h,targetPrizeIndex:c,onSpinEnd:()=>{o(!1),u(!0)}}),(0,s.jsxs)("button",{disabled:0===e||d,onClick:g,className:"w-full py-4 bg-gold-400 disabled:opacity-50 disabled:cursor-not-allowed text-ocean-950 font-black text-xl rounded-full shadow-[0_0_30px_rgba(242,166,13,0.3)] hover:shadow-[0_0_50px_rgba(242,166,13,0.5)] transition-all active:scale-95 flex items-center justify-center gap-3",children:[(0,s.jsx)("span",{className:`material-symbols-outlined text-3xl ${d?"animate-spin":""}`,children:"casino"}),d?"SPINNING...":e>0?"START SPIN":"NO SPINS"]}),p&&m&&(0,s.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black/90 backdrop-blur-md animate-in fade-in duration-300",children:(0,s.jsxs)("div",{className:"bg-ocean-900 w-full max-w-sm rounded-3xl border border-gold-400/50 p-8 text-center shadow-2xl relative overflow-hidden",children:["WIN"===m.outcome&&(0,s.jsx)("div",{className:"absolute inset-0 bg-gold-400/10 animate-pulse"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)("div",{className:"size-20 bg-ocean-800 rounded-full mx-auto mb-4 flex items-center justify-center border-4 border-ocean-700",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-5xl text-gold-400",children:m.prize?.icon||"stars"})}),(0,s.jsx)("h2",{className:"text-2xl font-black text-white mb-2 uppercase italic",children:"WIN"===m.outcome?"You Won!":"So Close!"}),(0,s.jsx)("p",{className:"text-lg text-gold-400 font-bold mb-6",children:m.prize?.name}),"WIN"===m.outcome&&(0,s.jsx)("p",{className:"text-slate-400 text-sm mb-8",children:"This reward has been added to your wallet."}),(0,s.jsx)("button",{onClick:()=>{u(!1),m?.outcome==="WIN"&&a()},className:"w-full py-3 bg-white text-ocean-950 font-bold rounded-xl hover:bg-gray-100 transition-colors",children:"WIN"===m.outcome?"Awesome!":"Try Again"})]})]})})]})},d=({onPlayGame:e})=>(0,s.jsxs)("div",{className:"px-6 pt-6 pb-24",children:[(0,s.jsx)("div",{className:"flex justify-between items-end mb-6",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-white",children:["Active ",(0,s.jsx)("span",{className:"text-gold-400",children:"Events"})]}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:"Play, dine, and earn rewards"})]})}),(0,s.jsx)("div",{className:"flex overflow-x-auto no-scrollbar snap-x snap-mandatory gap-5 pb-8 -mx-6 px-6",children:(0,s.jsx)("div",{className:"relative flex-none w-[85%] snap-center rounded-3xl overflow-hidden aspect-[4/5] bg-ocean-800 border border-gold-400/30 shadow-[0_0_25px_rgba(242,166,13,0.15)] group",children:(0,s.jsxs)("div",{className:"absolute inset-0 p-7 flex flex-col justify-between z-10",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded text-[10px] font-bold bg-gold-400 text-ocean-950 uppercase",children:"Daily"}),(0,s.jsx)("span",{className:"px-2 py-1 rounded text-[10px] font-bold bg-white/10 text-white uppercase border border-white/10",children:"Game"})]}),(0,s.jsxs)("h3",{className:"text-3xl font-bold text-white leading-tight mb-2",children:["Lucky Wheel",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-gold-400 italic",children:"1.0"})]}),(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"Spin for a chance to win exclusive Wagyu upgrades."})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-6 mt-auto",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-7xl text-gold-400 drop-shadow-[0_0_15px_rgba(242,166,13,0.6)]",children:"cyclone"}),(0,s.jsxs)("button",{onClick:e,className:"w-full py-4 bg-gold-400 hover:bg-gold-500 text-ocean-950 font-bold text-lg rounded-xl shadow-lg shadow-gold-400/20 transition-all active:scale-95 flex items-center justify-center gap-2",children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"play_circle"}),"Go Spin"]})]})]})})})]}),o=({rewards:e,points:a})=>{let[r,n]=(0,t.useState)(null),{actions:i}=(0,l.useAppStore)();return(0,t.useEffect)(()=>()=>{i.clearNewRewardFlag()},[]),(0,s.jsxs)("div",{className:"px-6 pt-8 pb-24",children:[(0,s.jsx)("h1",{className:"text-3xl font-black text-white mb-2",children:"My Rewards"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 mb-8",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-gold-400",children:"account_balance_wallet"}),(0,s.jsxs)("span",{children:["Balance: ",(0,s.jsxs)("strong",{className:"text-white",children:[a.toLocaleString()," Points"]})]})]}),(0,s.jsxs)("div",{className:"flex border-b border-ocean-700 mb-6",children:[(0,s.jsx)("button",{className:"pb-3 text-gold-400 font-bold text-sm border-b-2 border-gold-400 flex-1",children:"Available"}),(0,s.jsx)("button",{className:"pb-3 text-slate-500 font-medium text-sm flex-1",children:"History"})]}),(0,s.jsxs)("div",{className:"grid gap-4",children:[0===e.filter(e=>!e.isUsed).length&&(0,s.jsx)("div",{className:"text-slate-500 text-center py-10",children:"No available rewards. Go spin!"}),e.filter(e=>!e.isUsed).map(e=>(0,s.jsxs)("div",{onClick:()=>n(e),className:`relative bg-ocean-800 rounded-xl overflow-hidden border active:scale-[0.98] transition-transform cursor-pointer ${e.isNew?"border-gold-400 ring-2 ring-gold-400/30":"border-ocean-700"}`,children:[e.isNew&&(0,s.jsx)("div",{className:"absolute top-0 right-0 bg-gold-400 text-ocean-950 text-[10px] font-bold px-2 py-1 rounded-bl-lg z-20 uppercase tracking-wide",children:"Just Won"}),(0,s.jsx)("div",{className:"h-32 bg-cover bg-center relative",style:{backgroundImage:`url(${e.imageUrl})`},children:(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-black/60 backdrop-blur-sm px-2 py-1 rounded-md text-[10px] font-bold text-white border border-white/10",children:e.expiryDate})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"font-bold text-white text-lg",children:e.title}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mt-1 mb-4 line-clamp-2",children:e.description}),(0,s.jsx)("button",{className:"w-full py-2 bg-gold-400 text-ocean-950 font-bold text-sm rounded-lg",children:"Use Reward"})]})]},e.id))]}),r&&(0,s.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-ocean-900 w-full max-w-sm rounded-2xl border border-ocean-700 overflow-hidden relative animate-in fade-in zoom-in duration-200",children:[(0,s.jsx)("button",{onClick:()=>n(null),className:"absolute top-4 right-4 p-2 bg-black/20 rounded-full text-white z-10",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"close"})}),(0,s.jsx)("div",{className:"h-40 bg-cover bg-center",style:{backgroundImage:`url(${r.imageUrl})`}}),(0,s.jsxs)("div",{className:"p-6 text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:r.title}),(0,s.jsx)("p",{className:"text-slate-400 text-xs mb-6",children:"Show this code to server"}),(0,s.jsx)("div",{className:"bg-white p-4 rounded-xl mb-4 inline-block",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-8xl text-black",children:"qr_code_2"})}),(0,s.jsx)("p",{className:"text-2xl font-mono font-bold text-white tracking-widest mb-6",children:r.code})]})]})})]})},c=({user:e})=>{let{actions:r}=(0,l.useAppStore)(),[n,i]=(0,t.useState)(100),d=async s=>{let t=await r.convertPointsToSpins(e.id,s);t.success,alert(t.message)};return(0,s.jsxs)("div",{className:"px-6 pt-12 pb-24",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,s.jsx)("div",{className:"size-20 rounded-full bg-cover bg-center border-4 border-ocean-700",style:{backgroundImage:`url(${e.avatarUrl})`}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:e.name}),(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:e.email}),(0,s.jsxs)("span",{className:"inline-block mt-1 px-2 py-0.5 bg-blue-500/20 text-blue-400 text-[10px] font-bold uppercase rounded",children:["Member since ",e.joinedDate]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 mb-8 text-ocean-950 shadow-lg text-center relative overflow-hidden group",children:[(0,s.jsx)("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-500 mb-4",children:"My Member ID"}),(0,s.jsx)("div",{className:"bg-white p-2 rounded-xl inline-block mx-auto border-4 border-ocean-950 mb-2",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-9xl text-ocean-950",children:"qr_code_2"})}),(0,s.jsx)("p",{className:"text-4xl font-mono font-black tracking-wider text-ocean-900",children:e.publicId}),(0,s.jsx)("p",{className:"text-[10px] font-medium mt-2 text-slate-500",children:"Show to staff to earn points"})]}),(0,s.jsxs)("div",{className:"bg-ocean-800 rounded-xl p-4 flex justify-between items-center mb-8 border border-ocean-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-3 bg-blue-500/10 rounded-lg text-blue-400",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"casino"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Spins"}),(0,s.jsx)("p",{className:"text-xl font-bold text-white",children:e.spins})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-3 bg-gold-400/10 rounded-lg text-gold-400",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"stars"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Points"}),(0,s.jsx)("p",{className:"text-xl font-bold text-white",children:e.points})]})]})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-br from-ocean-800 to-ocean-900 rounded-xl p-6 mb-8 border border-gold-400/20 shadow-[0_0_15px_rgba(242,166,13,0.1)]",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-2 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-gold-400",children:"swap_horiz"}),"Convert Points"]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-4",children:"100 Points = 1 Lucky Spin"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>d(1),disabled:100>(e.points||0),className:"flex flex-col items-center justify-center p-3 rounded-xl bg-ocean-700 hover:bg-ocean-600 disabled:opacity-50 disabled:hover:bg-ocean-700 border border-ocean-600 transition-colors",children:[(0,s.jsx)("span",{className:"text-white font-bold",children:"1 Spin"}),(0,s.jsx)("span",{className:"text-[10px] text-gold-400 font-bold",children:"100 pts"})]}),(0,s.jsxs)("button",{onClick:()=>d(5),disabled:500>(e.points||0),className:"flex flex-col items-center justify-center p-3 rounded-xl bg-ocean-700 hover:bg-ocean-600 disabled:opacity-50 disabled:hover:bg-ocean-700 border border-ocean-600 transition-colors",children:[(0,s.jsx)("span",{className:"text-white font-bold",children:"5 Spins"}),(0,s.jsx)("span",{className:"text-[10px] text-gold-400 font-bold",children:"500 pts"})]})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("button",{onClick:async()=>{console.log("[Logout] Clicked"),r.setLoading(!0);try{let{error:e}=await a.supabase.auth.signOut();e&&console.error("SignOut error:",e),r.setUser(null),window.location.href="/"}catch(e){console.error("Logout failed",e),r.setLoading(!1)}},className:"w-full flex items-center justify-between p-4 bg-ocean-800/50 hover:bg-ocean-800 rounded-xl text-white text-sm font-medium transition-colors border border-transparent hover:border-ocean-700",children:[(0,s.jsx)("span",{children:"Log Out"}),(0,s.jsx)("span",{className:"material-symbols-outlined text-slate-500",children:"logout"})]})})]})},x=({user:e,rewards:t,onNavigate:l,currentView:a,onSpin:n})=>(0,s.jsxs)("div",{className:"min-h-screen bg-ocean-950 font-sans text-slate-200 relative max-w-md mx-auto shadow-2xl overflow-hidden",children:[(0,s.jsxs)("header",{className:"sticky top-0 z-40 bg-ocean-900/80 backdrop-blur-md border-b border-ocean-800 px-5 py-3 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-gold-400",children:"water_drop"}),(0,s.jsx)("span",{className:"font-bold text-white uppercase tracking-wider text-sm",children:"Ocean Sumria"})]}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)("div",{className:"size-8 rounded-full bg-cover bg-center border border-ocean-700",style:{backgroundImage:`url(${e.avatarUrl})`}})})]}),(0,s.jsxs)("main",{className:"min-h-[calc(100vh-130px)]",children:["home"===a&&(0,s.jsx)(d,{onPlayGame:()=>l("game")}),"game"===a&&(0,s.jsx)(i,{spins:e.spins||0,onBack:()=>l("home"),onSpin:n}),"rewards"===a&&(0,s.jsx)(o,{rewards:t,points:e.points||0}),"profile"===a&&(0,s.jsx)(c,{user:e})]}),(0,s.jsx)(r,{currentView:"game"===a?"home":a,onNavigate:l})]});var m=e.i(64807);let b=({onClose:e,onScan:l,type:a})=>{let r=(0,t.useRef)(null),[n,i]=(0,t.useState)(null);return(0,t.useEffect)(()=>{let e,s=null;return(async()=>{try{s=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),r.current&&(r.current.srcObject=s,r.current.play()),e=setTimeout(()=>{navigator.vibrate&&navigator.vibrate(200),l("customer"===a?"OS-8X29":"XC-992-00")},2500)}catch(s){console.error("Camera error",s),i("Camera access denied or unavailable. Simulating scan..."),e=setTimeout(()=>{l("customer"===a?"OS-8X29":"XC-992-00")},1500)}})(),()=>{s&&s.getTracks().forEach(e=>e.stop()),clearTimeout(e)}},[l,a]),(0,s.jsxs)("div",{className:"fixed inset-0 z-[60] bg-black text-white flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 bg-black/50 absolute top-0 left-0 right-0 z-10 backdrop-blur-sm",children:[(0,s.jsxs)("h3",{className:"font-bold text-lg flex items-center gap-2",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-gold-400",children:"qr_code_scanner"}),"Scanning ","customer"===a?"Customer":"Coupon"]}),(0,s.jsx)("button",{onClick:e,className:"p-2 bg-white/10 rounded-full",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"close"})})]}),(0,s.jsxs)("div",{className:"flex-1 relative overflow-hidden bg-slate-900 flex items-center justify-center",children:[n?(0,s.jsxs)("div",{className:"text-center p-6 text-slate-400",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-4xl mb-2",children:"videocam_off"}),(0,s.jsx)("p",{children:n})]}):(0,s.jsx)("video",{ref:r,className:"absolute inset-0 w-full h-full object-cover",playsInline:!0,muted:!0}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-10 pointer-events-none",children:(0,s.jsxs)("div",{className:"w-64 h-64 border-2 border-gold-400/50 rounded-xl relative",children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-gold-400 -mt-1 -ml-1 rounded-tl-lg"}),(0,s.jsx)("div",{className:"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-gold-400 -mt-1 -mr-1 rounded-tr-lg"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-gold-400 -mb-1 -ml-1 rounded-bl-lg"}),(0,s.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-gold-400 -mb-1 -mr-1 rounded-br-lg"}),(0,s.jsx)("div",{className:"absolute left-2 right-2 h-0.5 bg-gold-400 shadow-[0_0_10px_#f2a60d] animate-[bounce_2s_infinite]"})]})}),(0,s.jsx)("p",{className:"absolute bottom-20 left-0 right-0 text-center text-sm font-medium text-white/80 drop-shadow-md",children:"Align QR code within the frame"})]})]})},p=({user:e,onGrantSpins:r,onRedeemCoupon:n})=>{let{state:i,actions:d}=(0,l.useAppStore)(),[o,c]=(0,t.useState)("loyalty"),[x,p]=(0,t.useState)("OS-8X29"),[u,h]=(0,t.useState)(null),[g,f]=(0,t.useState)(""),[j,N]=(0,t.useState)(""),[v,w]=(0,t.useState)(null),[y,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)("customer"),_=async()=>{d.setLoading(!0);try{let e=x.trim().toUpperCase(),{data:s,error:t}=await a.supabase.from("profiles").select("*").eq("public_id",e).single();if(s){let e={id:s.id,publicId:s.public_id,name:s.name||s.email,email:s.email,role:(0,m.normalizeRole)(s.role),avatarUrl:`https://ui-avatars.com/api/?name=${s.email}&background=random`,points:s.points,spins:s.spins,joinedDate:new Date(s.created_at).toLocaleDateString()};h(e),w(null)}else h(null),w({msg:"Customer not found",type:"error"})}catch(e){console.error("Lookup failed",e),h(null),w({msg:"Lookup failed",type:"error"})}finally{d.setLoading(!1)}},I=async()=>{if(!u)return;let s=parseFloat(g);if(isNaN(s)||s<=0)return void w({msg:"Invalid bill amount",type:"error"});d.setLoading(!0);let t=await d.grantSpinsByPublicId(e.id,u.publicId,s);if(t.success){w({msg:t.message,type:"success"}),f("");let{data:e}=await a.supabase.from("profiles").select("points, spins").eq("id",u.id).single();e&&h(s=>s?{...s,points:e.points,spins:e.spins}:null)}else w({msg:t.message,type:"error"});d.setLoading(!1)},z=e=>{C(e),k(!0)};return(0,s.jsxs)("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-sans text-slate-900 dark:text-white flex flex-col",children:[y&&(0,s.jsx)(b,{type:S,onClose:()=>k(!1),onScan:e=>{k(!1),"customer"===S?(p(e),setTimeout(()=>{let s=Object.values(i.users).find(s=>s.publicId===e.trim());s&&"CUSTOMER"===s.role?(h(s),w({msg:`Found ${s.name}`,type:"success"})):(h(null),w({msg:`Customer ID ${e} not found`,type:"error"}))},100)):(N(e),w({msg:'Code scanned. Tap "Verify & Redeem" to confirm.',type:"success"}))}}),(0,s.jsx)("div",{className:"flex-grow flex justify-center items-start p-4 md:p-10",children:(0,s.jsxs)("div",{className:"w-full max-w-[420px] bg-white dark:bg-surface-dark rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden flex flex-col",children:[(0,s.jsxs)("header",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center size-8 bg-blue-100 text-blue-600 rounded-lg",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"admin_panel_settings"})}),(0,s.jsx)("h2",{className:"text-lg font-bold",children:"Staff Portal"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"size-8 rounded-full bg-cover bg-center",style:{backgroundImage:`url(${e.avatarUrl})`}}),(0,s.jsx)("button",{onClick:async()=>{d.setLoading(!0),await a.supabase.auth.signOut(),d.setUser(null),window.location.href="/"},className:"text-xs font-bold text-red-500 hover:text-red-700 underline",children:"Log Out"})]})]}),(0,s.jsx)("div",{className:"px-6 pt-6 pb-2",children:(0,s.jsxs)("div",{className:"flex p-1 bg-slate-100 dark:bg-slate-700 rounded-xl",children:[(0,s.jsx)("button",{onClick:()=>{c("loyalty"),w(null)},className:`flex-1 py-2.5 px-3 rounded-lg text-sm font-semibold transition-all ${"loyalty"===o?"bg-white text-blue-600 shadow-sm":"text-slate-500"}`,children:"Add Points"}),(0,s.jsx)("button",{onClick:()=>{c("redeem"),w(null)},className:`flex-1 py-2.5 px-3 rounded-lg text-sm font-semibold transition-all ${"redeem"===o?"bg-white text-blue-600 shadow-sm":"text-slate-500"}`,children:"Redeem"})]})}),(0,s.jsxs)("div",{className:"px-6 py-6 flex flex-col gap-6",children:["loyalty"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Customer Loyalty"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Look up customer to add points."})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:"id_card"})}),(0,s.jsx)("input",{type:"text",placeholder:"Customer ID",value:x,onChange:e=>p(e.target.value.toUpperCase()),className:"w-full pl-10 pr-3 py-3 bg-slate-50 border border-slate-200 rounded-xl font-bold focus:ring-2 focus:ring-blue-600 outline-none uppercase text-slate-900"})]}),(0,s.jsx)("button",{onClick:()=>z("customer"),className:"bg-slate-100 hover:bg-slate-200 text-slate-700 px-3 rounded-xl border border-slate-200",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"qr_code_scanner"})}),(0,s.jsx)("button",{onClick:_,className:"bg-slate-900 text-white px-4 rounded-xl font-bold text-sm",children:"Find"})]}),u&&(0,s.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 animate-in fade-in slide-in-from-top-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"size-10 rounded-full bg-cover bg-center",style:{backgroundImage:`url(${u.avatarUrl})`}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-slate-900",children:u.name}),(0,s.jsx)("p",{className:"text-xs text-slate-500 font-mono",children:u.publicId})]}),(0,s.jsxs)("div",{className:"ml-auto text-right",children:[(0,s.jsxs)("p",{className:"text-lg font-bold text-gold-500",children:[u.points," pts"]}),(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:[u.spins," spins"]})]})]}),(0,s.jsxs)("div",{className:"border-t border-slate-200 pt-4",children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Bill Amount"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-bold",children:"$"}),(0,s.jsx)("input",{type:"number",value:g,onChange:e=>f(e.target.value),placeholder:"0.00",className:"w-full pl-7 pr-3 py-2 bg-white border border-slate-300 rounded-lg font-bold text-lg focus:ring-2 focus:ring-blue-600 outline-none text-slate-900"})]}),(0,s.jsxs)("button",{onClick:I,disabled:!g,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-1",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-sm",children:"add"}),Math.floor(parseFloat(g)||0)," Pts"]})]}),(0,s.jsx)("p",{className:"text-[10px] text-slate-400 mt-2",children:"$1.00 = 1 Point"})]})]})]}),"redeem"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Redeem Coupon"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Scan customer QR or enter code."})]}),(0,s.jsxs)("button",{onClick:()=>z("coupon"),className:"w-full aspect-[4/2] bg-slate-50 border-2 border-dashed border-slate-300 rounded-2xl flex flex-col items-center justify-center gap-3 hover:border-blue-600 hover:bg-blue-50 transition-all cursor-pointer",children:[(0,s.jsx)("div",{className:"size-16 bg-white rounded-full shadow-sm flex items-center justify-center",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-3xl text-blue-600",children:"qr_code_scanner"})}),(0,s.jsx)("span",{className:"text-sm font-semibold text-slate-600",children:"Tap to Scan Camera"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:"confirmation_number"})}),(0,s.jsx)("input",{type:"text",placeholder:"ENTER COUPON CODE",value:j,onChange:e=>N(e.target.value.toUpperCase()),className:"w-full pl-11 pr-4 py-3.5 bg-white border border-slate-300 rounded-xl text-base font-medium focus:ring-2 focus:ring-blue-600 outline-none uppercase"})]}),(0,s.jsx)("button",{onClick:()=>{!j||window.confirm(`Irreversibly redeem coupon ${j}?`)&&(n(j)?(w({msg:`Redeemed coupon ${j}`,type:"success"}),N("")):w({msg:"Coupon invalid or already used",type:"error"}))},disabled:!j,className:"w-full bg-slate-900 text-white font-bold text-lg py-3.5 rounded-xl shadow-lg hover:opacity-90 transition-all disabled:opacity-50",children:"Verify & Redeem"})]}),v&&(0,s.jsxs)("div",{className:`border p-3 rounded-lg text-sm flex items-center gap-2 animate-bounce ${"success"===v.type?"bg-green-100 border-green-200 text-green-800":"bg-red-100 border-red-200 text-red-800"}`,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"success"===v.type?"check_circle":"error"}),v.msg]})]})]})})]})},u=({user:e,prizes:l,logs:a,rewards:r})=>{let[n,i]=(0,t.useState)("dashboard"),[d,o]=(0,t.useState)("SPIN"),c=a.filter(e=>"EARN_POINTS"===e.action).reduce((e,s)=>{let t=s.details.match(/Earned (\d+)/);return e+(t?parseInt(t[1]):0)},0),x=a.filter(e=>"CONVERT_POINTS"===e.action).reduce((e,s)=>{let t=s.details.match(/Converted (\d+)/);return e+(t?parseInt(t[1]):0)},0),m=a.filter(e=>"SPIN"===e.action).length,b=r.filter(e=>e.isUsed).length,p={};return a.filter(e=>"SPIN"===e.action).forEach(e=>{let s=e.details.replace("Result: ","");p[s]=(p[s]||0)+1}),Object.entries(p).sort((e,s)=>s[1]-e[1])[0]?.[0],(0,s.jsxs)("div",{className:"min-h-screen bg-slate-50 font-sans text-slate-900 flex",children:[(0,s.jsxs)("aside",{className:"w-64 bg-white border-r border-slate-200 hidden lg:flex flex-col",children:[(0,s.jsxs)("div",{className:"p-6 flex items-center gap-3",children:[(0,s.jsx)("div",{className:"size-8 bg-gold-400 rounded-lg flex items-center justify-center text-white font-bold",children:"OS"}),(0,s.jsx)("span",{className:"font-bold text-slate-800",children:"Admin Console"})]}),(0,s.jsxs)("nav",{className:"flex-1 px-4 py-4 space-y-1",children:[(0,s.jsxs)("button",{onClick:()=>i("dashboard"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${"dashboard"===n?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50"}`,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"dashboard"}),"Dashboard"]}),(0,s.jsxs)("button",{onClick:()=>i("prizes"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${"prizes"===n?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50"}`,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"redeem"}),"Prize Config"]}),(0,s.jsxs)("button",{onClick:()=>i("logs"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${"logs"===n?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50"}`,children:[(0,s.jsx)("span",{className:"material-symbols-outlined",children:"description"}),"Activity Logs"]})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.avatarUrl,className:"size-8 rounded-full",alt:"Admin"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("p",{className:"font-bold text-slate-900",children:e.name}),(0,s.jsx)("p",{className:"text-slate-500",children:"Manager"})]})]})})]}),(0,s.jsxs)("main",{className:"flex-1 flex flex-col h-screen overflow-hidden",children:[(0,s.jsxs)("header",{className:"bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 lg:px-8 shrink-0",children:[(0,s.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,s.jsx)("span",{className:"lg:hidden material-symbols-outlined",children:"menu"}),(0,s.jsx)("span",{className:"uppercase",children:n})]}),(0,s.jsx)("div",{className:"flex gap-2",children:"prizes"===n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg",children:"Discard"}),(0,s.jsx)("button",{className:"px-4 py-2 text-sm font-bold bg-gold-400 hover:bg-gold-500 text-white rounded-lg shadow-sm",children:"Publish Live"})]})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 lg:p-8",children:["dashboard"===n&&(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm font-bold uppercase",children:"Points Earned"}),(0,s.jsx)("p",{className:"text-3xl font-black text-slate-900 mt-2",children:c})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm font-bold uppercase",children:"Points Converted"}),(0,s.jsx)("p",{className:"text-3xl font-black text-slate-900 mt-2",children:x})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm font-bold uppercase",children:"Spins Used"}),(0,s.jsx)("p",{className:"text-3xl font-black text-slate-900 mt-2",children:m})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm font-bold uppercase",children:"Redemptions"}),(0,s.jsx)("p",{className:"text-3xl font-black text-slate-900 mt-2",children:b})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("h3",{className:"font-bold text-slate-900 mb-4",children:"Recent Activity"}),(0,s.jsx)("div",{className:"space-y-4",children:a.slice(0,5).map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,s.jsx)("span",{className:"text-slate-400 font-mono text-xs mt-0.5",children:e.timestamp.split(" ")[1]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium text-slate-900",children:[e.action,": ",e.details]}),(0,s.jsxs)("p",{className:"text-slate-500 text-xs",children:["by ",e.userName]})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,s.jsx)("h3",{className:"font-bold text-slate-900 mb-4",children:"Risk Monitor"}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)("div",{className:"size-16 rounded-full border-4 border-green-500 flex items-center justify-center",children:(0,s.jsx)("span",{className:"font-bold text-green-700",children:"Low"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Current Payout Rate"}),(0,s.jsx)("p",{className:"text-xl font-bold",children:"12.5%"})]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Based on value of redeemed coupons vs bill total."})]})]})]}),"prizes"===n&&(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 flex gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-100 rounded-full text-orange-600 h-fit",children:(0,s.jsx)("span",{className:"material-symbols-outlined",children:"warning"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-orange-900 text-sm",children:"Daily Risk Indicator"}),(0,s.jsxs)("p",{className:"text-xs text-orange-800 mt-1",children:["High concentration of winners on ",(0,s.jsx)("span",{className:"font-bold",children:"10% Off"})," (76.9%)."]}),(0,s.jsx)("div",{className:"w-48 h-1.5 bg-orange-200 rounded-full mt-2 overflow-hidden",children:(0,s.jsx)("div",{className:"bg-orange-500 w-[75%] h-full"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[(0,s.jsx)("h3",{className:"font-bold text-slate-800",children:"Prize Items"}),(0,s.jsx)("button",{className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Prize"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,s.jsx)("thead",{className:"bg-slate-50 text-slate-500 font-medium border-b border-slate-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3",children:"Prize Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center",children:"Weight"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center",children:"Total Avail"}),(0,s.jsx)("th",{className:"px-6 py-3",children:"Win Limit"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-100",children:l.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,s.jsxs)("td",{className:"px-6 py-4 font-medium text-slate-900 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-slate-400",children:e.icon}),e.name]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,s.jsx)("input",{type:"number",className:"w-16 px-2 py-1 border border-slate-300 rounded text-center",defaultValue:e.weight})})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsx)("span",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-mono",children:e.totalAvailable})}),(0,s.jsx)("td",{className:"px-6 py-4 text-slate-600",children:e.winLimit}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsx)("div",{className:`inline-block w-3 h-3 rounded-full ${e.active?"bg-green-500":"bg-slate-300"}`})}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:(0,s.jsx)("button",{className:"text-slate-400 hover:text-blue-600",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:"edit"})})})]},e.id))})]})})]})]}),"logs"===n&&(0,s.jsxs)("div",{className:"max-w-[1200px] mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-end justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Activity Logs"}),(0,s.jsx)("p",{className:"text-slate-500 text-base max-w-2xl",children:"Audit trail for spins, redemptions, and administrative grants."})]}),(0,s.jsxs)("button",{className:"flex items-center gap-2 h-10 px-4 bg-white border border-slate-200 text-slate-900 text-sm font-semibold rounded-lg hover:bg-slate-50 transition-colors shadow-sm",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-lg",children:"download"}),(0,s.jsx)("span",{children:"Export CSV"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"border-b border-slate-200 px-6",children:(0,s.jsxs)("div",{className:"flex gap-8 overflow-x-auto",children:[(0,s.jsx)("button",{onClick:()=>o("SPIN"),className:`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${"SPIN"===d?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200"}`,children:(0,s.jsx)("span",{children:"Spin Log"})}),(0,s.jsx)("button",{onClick:()=>o("REDEMPTION"),className:`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${"REDEMPTION"===d?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200"}`,children:(0,s.jsx)("span",{children:"Redeems"})}),(0,s.jsx)("button",{onClick:()=>o("EARN_POINTS"),className:`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${"EARN_POINTS"===d?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200"}`,children:(0,s.jsx)("span",{children:"Points Earned"})})]})}),(0,s.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,s.jsx)("thead",{className:"bg-slate-50 text-slate-500 font-medium border-b border-slate-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-3 px-6 text-xs font-semibold uppercase tracking-wider",children:"Timestamp"}),(0,s.jsx)("th",{className:"py-3 px-6 text-xs font-semibold uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"py-3 px-6 text-xs font-semibold uppercase tracking-wider",children:"Details"}),(0,s.jsx)("th",{className:"py-3 px-6 text-xs font-semibold uppercase tracking-wider text-right",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-100",children:a.filter(e=>e.action===d||"EARN_POINTS"===d&&("EARN_POINTS"===e.action||"CONVERT_POINTS"===e.action)).map(e=>{var t,l;return(0,s.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group cursor-pointer",children:[(0,s.jsx)("td",{className:"py-4 px-6 text-slate-500",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.timestamp.split(",")[0]}),(0,s.jsx)("span",{className:"text-xs text-slate-400",children:e.timestamp.split(",")[1]||""})]})}),(0,s.jsx)("td",{className:"py-4 px-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.userAvatar,className:"size-8 rounded-full",alt:""}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-900 group-hover:text-blue-600 transition-colors",children:e.userName}),(0,s.jsxs)("span",{className:"text-xs text-slate-400",children:["user_",e.userId]})]})]})}),(0,s.jsx)("td",{className:"py-4 px-6",children:(t=e.action,l=e.details,"SPIN"===t?(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-green-50 border border-green-100",children:[(0,s.jsx)("span",{className:"size-1.5 rounded-full bg-green-500"}),(0,s.jsx)("span",{className:"text-xs font-medium text-green-700",children:l})]}):"REDEMPTION"===t?(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-blue-50 border border-blue-100",children:[(0,s.jsx)("span",{className:"size-1.5 rounded-full bg-blue-500"}),(0,s.jsx)("span",{className:"text-xs font-medium text-blue-700",children:l})]}):"EARN_POINTS"===t?(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-yellow-50 border border-yellow-100",children:[(0,s.jsx)("span",{className:"size-1.5 rounded-full bg-yellow-500"}),(0,s.jsx)("span",{className:"text-xs font-medium text-yellow-700",children:l})]}):"CONVERT_POINTS"===t?(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-indigo-50 border border-indigo-100",children:[(0,s.jsx)("span",{className:"size-1.5 rounded-full bg-indigo-500"}),(0,s.jsx)("span",{className:"text-xs font-medium text-indigo-700",children:l})]}):(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-purple-50 border border-purple-100",children:[(0,s.jsx)("span",{className:"size-1.5 rounded-full bg-purple-500"}),(0,s.jsx)("span",{className:"text-xs font-medium text-purple-700",children:l})]}))}),(0,s.jsx)("td",{className:"py-4 px-6 text-right",children:(0,s.jsx)("button",{className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors inline-block",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-lg align-middle",children:"visibility"})})})]},e.id)})})]})]})]})]})]})]})},h=()=>{let[e,l]=(0,t.useState)(!1),[r,n]=(0,t.useState)(null),i=async e=>{l(!0),n(null);try{let{error:s}=await a.supabase.auth.signInWithOAuth({provider:e,options:{redirectTo:window.location.origin}});if(s)throw s}catch(e){n(e.message||"Login failed"),l(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-ocean-950 flex flex-col items-center justify-center p-6 relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-[-20%] left-[-20%] w-[600px] h-[600px] bg-blue-600/20 rounded-full blur-[120px] pointer-events-none"}),(0,s.jsx)("div",{className:"absolute bottom-[-20%] right-[-20%] w-[500px] h-[500px] bg-gold-400/10 rounded-full blur-[100px] pointer-events-none"}),(0,s.jsxs)("div",{className:"w-full max-w-sm z-10 animate-in fade-in zoom-in duration-500",children:[(0,s.jsxs)("div",{className:"text-center mb-10",children:[(0,s.jsx)("div",{className:"size-20 bg-ocean-900 border-2 border-gold-400 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl shadow-gold-400/20",children:(0,s.jsx)("span",{className:"material-symbols-outlined text-4xl text-gold-400",children:"water_drop"})}),(0,s.jsx)("h1",{className:"text-3xl font-black text-white mb-2 tracking-tight",children:"Ocean Sumria"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Rewards & Loyalty Program"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("button",{onClick:()=>i("google"),disabled:e,className:"w-full bg-white hover:bg-slate-50 text-slate-900 font-bold py-3.5 px-4 rounded-xl flex items-center justify-center gap-3 transition-transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-wait",children:[(0,s.jsx)("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",className:"w-5 h-5",alt:"Google"}),"Continue with Google"]}),(0,s.jsxs)("button",{onClick:()=>i("apple"),disabled:e,className:"w-full bg-black hover:bg-slate-900 text-white font-bold py-3.5 px-4 rounded-xl flex items-center justify-center gap-3 transition-transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-wait border border-white/10",children:[(0,s.jsx)("span",{className:"material-symbols-outlined text-[20px]",children:"apple"}),"Continue with Apple"]})]}),r&&(0,s.jsx)("div",{className:"mt-6 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:r}),(0,s.jsx)("div",{className:"mt-12 text-center",children:(0,s.jsxs)("p",{className:"text-xs text-slate-500",children:["By continuing, you agree to our ",(0,s.jsx)("a",{href:"#",className:"underline hover:text-slate-400",children:"Terms"})," and ",(0,s.jsx)("a",{href:"#",className:"underline hover:text-slate-400",children:"Privacy Policy"}),"."]})})]})]})};function g(){let{state:e,actions:a}=(0,l.useAppStore)(),[r,n]=(0,t.useState)("home");if((0,t.useEffect)(()=>{if(!e.currentUser)return void window.history.replaceState(null,"","/login");let s=e.currentUser.role,t="/";s===m.UserRole.STAFF&&(t="/staff"),s===m.UserRole.ADMIN&&(t="/admin"),window.location.pathname!==t&&window.history.pushState(null,"",t)},[e.currentUser]),e.isLoading)return(0,s.jsx)("div",{className:"min-h-screen bg-ocean-950 flex items-center justify-center",children:(0,s.jsx)("div",{className:"size-12 border-4 border-gold-400 border-t-transparent rounded-full animate-spin"})});if(!e.currentUser)return(0,s.jsx)(h,{});let i=async()=>e.currentUser?.role===m.UserRole.CUSTOMER?await a.spinWheel(e.currentUser.id):{ok:!1,error:"Invalid role"};switch(e.currentUser.role){case m.UserRole.CUSTOMER:return(0,s.jsx)(x,{user:e.currentUser,rewards:e.rewards,onNavigate:n,currentView:r,onSpin:i});case m.UserRole.STAFF:return(0,s.jsx)(p,{user:e.currentUser,onGrantSpins:(s,t)=>(a.grantSpinsByPublicId(e.currentUser.id,s,t),{success:!0,message:"Processing transaction..."}),onRedeemCoupon:s=>(a.redeemCoupon(e.currentUser.id,s),!0)});case m.UserRole.ADMIN:return(0,s.jsx)(u,{user:e.currentUser,prizes:e.prizes,logs:e.logs,rewards:e.rewards});default:return(0,s.jsx)("div",{children:"Unknown Role"})}}function f(){return(0,s.jsx)(g,{})}e.s(["default",()=>f],20613)},48137,e=>{e.n(e.i(20613))}]);