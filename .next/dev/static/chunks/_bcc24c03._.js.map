{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/types.ts"],"sourcesContent":["export enum UserRole {\n  CUSTOMER = 'CUSTOMER',\n  STAFF = 'STAFF',\n  ADMIN = 'ADMIN'\n}\n\nexport interface User {\n  id: string;\n  publicId: string; // Unique 6-char ID for staff lookup (e.g., \"OS-9921\")\n  name: string;\n  email: string;\n  role: UserRole;\n  avatarUrl: string;\n  points?: number; // Customer only\n  spins?: number; // Customer only\n  joinedDate?: string;\n}\n\nexport interface Reward {\n  id: string;\n  title: string;\n  description: string;\n  expiryDate: string;\n  isUsed: boolean;\n  type: 'DISCOUNT' | 'FREE_ITEM' | 'BOGO';\n  code: string; // The QR code content\n  imageUrl: string;\n  isNew?: boolean; // To highlight newly won rewards\n}\n\nexport interface PrizeConfig {\n  id: string;\n  name: string;\n  weight: number; // Probability weight\n  totalAvailable: number | 'unlimited';\n  winLimit: string;\n  active: boolean;\n  icon: string;\n  color?: string; // For the wheel segment\n}\n\nexport interface ActivityLog {\n  id: string;\n  timestamp: string;\n  userId: string;\n  publicId?: string; // To show in logs\n  userName: string;\n  userAvatar: string;\n  action: 'SPIN' | 'REDEMPTION' | 'GRANT' | 'EARN_POINTS' | 'CONVERT_POINTS';\n  details: string; // \"Won 10% Off\" or \"Granted 3 spins\"\n  probabilityTier?: string;\n}\n\nexport interface SpinResult {\n  ok: boolean;\n  prize?: PrizeConfig;\n  reward?: Reward;\n  error?: string;\n  outcome?: 'WIN' | 'NO_WIN';\n}\n\nexport interface AppState {\n  currentUser: User | null;\n  activeRole: UserRole;\n  users: Record<string, User>; // Global registry of users\n  rewards: Reward[];\n  logs: ActivityLog[];\n  prizes: PrizeConfig[];\n  lastCreatedRewardId: string | null;\n}"],"names":[],"mappings":";;;;AAAO,IAAA,AAAK,kCAAA;;;;WAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/services/mockData.ts"],"sourcesContent":["import { User, UserRole, Reward, PrizeConfig, ActivityLog } from '../types';\n\n// --- Mock Users ---\nexport const MOCK_USERS: Record<string, User> = {\n  customer: {\n    id: 'c1',\n    publicId: 'OS-8X29',\n    name: 'Alex Johnson',\n    email: 'alex.j@example.com',\n    role: UserRole.CUSTOMER,\n    avatarUrl: 'https://picsum.photos/seed/alex/100/100',\n    points: 350,\n    spins: 2,\n    joinedDate: 'Oct 2023'\n  },\n  customer2: {\n    id: 'c2',\n    publicId: 'OS-331B',\n    name: 'Sarah Connor',\n    email: 'sarah.c@example.com',\n    role: UserRole.CUSTOMER,\n    avatarUrl: 'https://picsum.photos/seed/sarah/100/100',\n    points: 120,\n    spins: 0,\n    joinedDate: 'Nov 2023'\n  },\n  staff: {\n    id: 's1',\n    publicId: 'ST-001',\n    name: 'David Chen',\n    email: 'staff@oceansumria.com',\n    role: UserRole.STAFF,\n    avatarUrl: 'https://picsum.photos/seed/david/100/100'\n  },\n  admin: {\n    id: 'a1',\n    publicId: 'AD-001',\n    name: 'Sarah Owner',\n    email: 'admin@oceansumria.com',\n    role: UserRole.ADMIN,\n    avatarUrl: 'https://picsum.photos/seed/sarah/100/100'\n  }\n};\n\n// --- Mock Rewards (Customer Wallet) ---\nexport const MOCK_REWARDS: Reward[] = [\n  {\n    id: 'r1',\n    title: 'Free Calamari Appetizer',\n    description: 'Crispy, golden-fried calamari rings with marinara.',\n    expiryDate: '2023-10-24',\n    isUsed: false,\n    type: 'FREE_ITEM',\n    code: 'XC-992-00',\n    imageUrl: 'https://picsum.photos/seed/calamari/300/200'\n  },\n  {\n    id: 'r2',\n    title: 'Spicy Tuna Roll',\n    description: 'Fresh tuna with spicy mayo.',\n    expiryDate: '2023-11-01',\n    isUsed: false,\n    type: 'FREE_ITEM',\n    code: 'ST-112-99',\n    imageUrl: 'https://picsum.photos/seed/sushi/300/200'\n  },\n  {\n    id: 'r3',\n    title: '10% Off Total Bill',\n    description: 'Valid for dine-in only.',\n    expiryDate: '2023-10-20',\n    isUsed: true,\n    type: 'DISCOUNT',\n    code: '10-OFF-OLD',\n    imageUrl: 'https://picsum.photos/seed/discount/300/200'\n  }\n];\n\n// --- Mock Prize Configuration (Admin) ---\nexport const MOCK_PRIZES: PrizeConfig[] = [\n  { id: 'p1', name: 'Free Burger', weight: 10, totalAvailable: 500, winLimit: '1/day', active: false, icon: 'lunch_dining', color: '#f2a60d' },\n  { id: 'p2', name: '10% Off', weight: 50, totalAvailable: 'unlimited', winLimit: 'None', active: true, icon: 'local_offer', color: '#3b82f6' },\n  { id: 'p3', name: 'Mystery Box', weight: 5, totalAvailable: 10, winLimit: '1/user', active: true, icon: 'inventory_2', color: '#8b5cf6' },\n  { id: 'p4', name: 'Free Drink', weight: 80, totalAvailable: 'unlimited', winLimit: 'None', active: true, icon: 'local_bar', color: '#10b981' },\n  // Adding a logic-only prize for \"No Win\" if weights don't add up, or explicit lose\n  { id: 'p_lose', name: 'Better Luck Next Time', weight: 20, totalAvailable: 'unlimited', winLimit: 'None', active: true, icon: 'mood_bad', color: '#64748b' }\n];\n\n// --- Mock Activity Logs ---\nexport const MOCK_LOGS: ActivityLog[] = [\n  {\n    id: 'l1',\n    timestamp: '2023-10-24 10:42 AM',\n    userId: 'c1',\n    publicId: 'OS-8X29',\n    userName: 'Alex Johnson',\n    userAvatar: 'https://picsum.photos/seed/alex/50/50',\n    action: 'SPIN',\n    details: 'Won Free Drink',\n    probabilityTier: 'Tier 3'\n  },\n  {\n    id: 'l2',\n    timestamp: '2023-10-24 09:15 AM',\n    userId: 'c2',\n    publicId: 'OS-331B',\n    userName: 'Sarah Connor',\n    userAvatar: 'https://picsum.photos/seed/alice/50/50',\n    action: 'REDEMPTION',\n    details: 'Redeemed 10% Off',\n  },\n  {\n    id: 'l3',\n    timestamp: '2023-10-23 04:30 PM',\n    userId: 's1',\n    userName: 'David Chen',\n    userAvatar: 'https://picsum.photos/seed/david/50/50',\n    action: 'EARN_POINTS',\n    details: 'Earned 105 Points ($105.00 Bill)',\n  },\n  {\n    id: 'l4',\n    timestamp: '2023-10-23 05:00 PM',\n    userId: 'c1',\n    publicId: 'OS-8X29',\n    userName: 'Alex Johnson',\n    userAvatar: 'https://picsum.photos/seed/alex/50/50',\n    action: 'CONVERT_POINTS',\n    details: 'Converted 200 pts to 2 Spins',\n  }\n];"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,aAAmC;IAC9C,UAAU;QACR,IAAI;QACJ,UAAU;QACV,MAAM;QACN,OAAO;QACP,MAAM,oHAAQ,CAAC,QAAQ;QACvB,WAAW;QACX,QAAQ;QACR,OAAO;QACP,YAAY;IACd;IACA,WAAW;QACT,IAAI;QACJ,UAAU;QACV,MAAM;QACN,OAAO;QACP,MAAM,oHAAQ,CAAC,QAAQ;QACvB,WAAW;QACX,QAAQ;QACR,OAAO;QACP,YAAY;IACd;IACA,OAAO;QACL,IAAI;QACJ,UAAU;QACV,MAAM;QACN,OAAO;QACP,MAAM,oHAAQ,CAAC,KAAK;QACpB,WAAW;IACb;IACA,OAAO;QACL,IAAI;QACJ,UAAU;QACV,MAAM;QACN,OAAO;QACP,MAAM,oHAAQ,CAAC,KAAK;QACpB,WAAW;IACb;AACF;AAGO,MAAM,eAAyB;IACpC;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,YAAY;QACZ,QAAQ;QACR,MAAM;QACN,MAAM;QACN,UAAU;IACZ;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,YAAY;QACZ,QAAQ;QACR,MAAM;QACN,MAAM;QACN,UAAU;IACZ;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,YAAY;QACZ,QAAQ;QACR,MAAM;QACN,MAAM;QACN,UAAU;IACZ;CACD;AAGM,MAAM,cAA6B;IACxC;QAAE,IAAI;QAAM,MAAM;QAAe,QAAQ;QAAI,gBAAgB;QAAK,UAAU;QAAS,QAAQ;QAAO,MAAM;QAAgB,OAAO;IAAU;IAC3I;QAAE,IAAI;QAAM,MAAM;QAAW,QAAQ;QAAI,gBAAgB;QAAa,UAAU;QAAQ,QAAQ;QAAM,MAAM;QAAe,OAAO;IAAU;IAC5I;QAAE,IAAI;QAAM,MAAM;QAAe,QAAQ;QAAG,gBAAgB;QAAI,UAAU;QAAU,QAAQ;QAAM,MAAM;QAAe,OAAO;IAAU;IACxI;QAAE,IAAI;QAAM,MAAM;QAAc,QAAQ;QAAI,gBAAgB;QAAa,UAAU;QAAQ,QAAQ;QAAM,MAAM;QAAa,OAAO;IAAU;IAC7I,mFAAmF;IACnF;QAAE,IAAI;QAAU,MAAM;QAAyB,QAAQ;QAAI,gBAAgB;QAAa,UAAU;QAAQ,QAAQ;QAAM,MAAM;QAAY,OAAO;IAAU;CAC5J;AAGM,MAAM,YAA2B;IACtC;QACE,IAAI;QACJ,WAAW;QACX,QAAQ;QACR,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,SAAS;QACT,iBAAiB;IACnB;IACA;QACE,IAAI;QACJ,WAAW;QACX,QAAQ;QACR,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,SAAS;IACX;IACA;QACE,IAAI;QACJ,WAAW;QACX,QAAQ;QACR,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,SAAS;IACX;IACA;QACE,IAAI;QACJ,WAAW;QACX,QAAQ;QACR,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,SAAS;IACX;CACD"}},
    {"offset": {"line": 207, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/services/supabase.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr';\n\n// Access env vars safely using Next.js standard\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nif (!supabaseUrl || !supabaseKey) {\n  console.warn('Supabase URL or Key is missing. Check .env.local');\n}\n\nexport const supabase = createBrowserClient(supabaseUrl, supabaseKey);"],"names":[],"mappings":";;;;AAGoB;AAHpB;AAAA;;AAEA,gDAAgD;AAChD,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,oMAAmB,EAAC,aAAa"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/services/api.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport { User, UserRole, Reward, SpinResult } from '../types';\nimport { MOCK_PRIZES } from './mockData'; // Keeping for fallback or types if needed, but logic is server side now\n\n/**\n * API Facade\n * \n * Connecting to Next.js API Routes.\n */\n\nexport const api = {\n  /**\n   * Fetch User Profile\n   * GET /api/auth/me\n   */\n  fetchProfile: async (userId: string, email: string): Promise<User> => {\n    try {\n      const res = await fetch('/api/auth/me');\n      const json = await res.json();\n\n      if (!res.ok) throw new Error(json.error || 'Failed to fetch profile');\n\n      const { user, profile } = json.data;\n\n      return {\n        id: user.id,\n        publicId: profile.public_id || 'UNKNOWN',\n        name: profile.name || email.split('@')[0],\n        email: profile.email || email,\n        role: profile.role as UserRole,\n        avatarUrl: `https://ui-avatars.com/api/?name=${profile.email}&background=random`,\n        points: profile.points,\n        spins: profile.spins,\n        joinedDate: new Date(profile.created_at).toLocaleDateString()\n      };\n    } catch (e) {\n      console.error(\"Profile fetch failed\", e);\n      throw e;\n    }\n  },\n\n  /**\n   * Staff: Add Points to Customer\n   * POST /api/staff/add-points\n   */\n  addPoints: async (staffId: string, customerPublicId: string, billAmount: number) => {\n    try {\n      const res = await fetch('/api/staff/add-points', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ publicId: customerPublicId, billAmountCents: Math.round(billAmount * 100), receiptRef: `REF-${Date.now()}` })\n      });\n      const json = await res.json();\n      if (!res.ok) return { success: false, message: json.error };\n\n      return { success: true, message: `Added points successfully`, pointsAdded: json.data.new_points };\n    } catch (e) {\n      return { success: false, message: (e as Error).message };\n    }\n  },\n\n  /**\n   * Customer: Convert Points to Spins\n   * POST /api/customer/convert-points\n   */\n  convertPoints: async (customerId: string, spinsToBuy: number) => {\n    try {\n      const res = await fetch('/api/customer/convert-points', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ spinsToBuy })\n      });\n      const json = await res.json();\n      if (!res.ok) return { success: false, message: json.error };\n\n      return { success: true, message: `Converted points to ${spinsToBuy} spins` };\n    } catch (e) {\n      return { success: false, message: (e as Error).message };\n    }\n  },\n\n  /**\n   * Customer: Spin the Wheel\n   * POST /api/customer/spin\n   */\n  spinWheel: async (customerId: string) => {\n    try {\n      const res = await fetch('/api/customer/spin', { method: 'POST' });\n      const json = await res.json();\n\n      if (!res.ok) return { ok: false, error: json.error };\n\n      const { outcome, prize_name, coupon_code, prize } = json.data;\n\n      let reward: Reward | undefined;\n      // If we need to construct a reward object for the frontend to display immediately\n      // The API returns the simpler details.\n      if (outcome !== 'no_win') {\n        reward = {\n          id: coupon_code || 'temp',\n          title: prize_name,\n          description: outcome === 'discount' ? 'Discount Reward' : 'Free Item Reward',\n          expiryDate: '7 days',\n          isUsed: false,\n          type: outcome === 'discount' ? 'DISCOUNT' : 'FREE_ITEM',\n          code: coupon_code,\n          imageUrl: prize?.icon || 'https://picsum.photos/seed/win/300/200',\n          isNew: true\n        };\n      }\n\n      return {\n        ok: true,\n        prize: { ...prize, id: prize?.id || 'unknown' }, // Map back to frontend type if roughly compatible\n        reward,\n        outcome: outcome === 'no_win' ? 'NO_WIN' : 'WIN'\n      };\n    } catch (e) {\n      return { ok: false, error: (e as Error).message };\n    }\n  },\n\n  /**\n   * Staff: Redeem Coupon\n   * POST /api/staff/redeem\n   */\n  redeemCoupon: async (staffId: string, code: string) => {\n    try {\n      const res = await fetch('/api/staff/redeem', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ code })\n      });\n      const json = await res.json();\n      return json.ok;\n    } catch (e) {\n      console.error(e);\n      return false;\n    }\n  },\n\n  /**\n   * Admin: Fetch Logs\n   * GET /api/admin/audit-logs\n   */\n  getLogs: async () => {\n    try {\n      const res = await fetch('/api/admin/audit-logs');\n      const json = await res.json();\n      if (!res.ok) return [];\n\n      // Map to frontend ActivityLog type\n      return json.data.map((log: any) => ({\n        id: log.id,\n        timestamp: new Date(log.created_at).toLocaleString(),\n        userId: log.actor_id,\n        userName: log.profiles?.name || 'Unknown',\n        userAvatar: '',\n        action: log.type,\n        details: JSON.stringify(log.metadata)\n      }));\n    } catch (e) {\n      console.error(e);\n      return [];\n    }\n  },\n\n  /**\n   * Admin: Publish Prize Pool\n   * POST /api/admin/pool/publish\n   */\n  publishPool: async (poolVersionId: string) => {\n    try {\n      const res = await fetch('/api/admin/pool/publish', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ poolVersionId })\n      });\n      const json = await res.json();\n      return { success: res.ok, message: json.ok ? 'Published' : json.error };\n    } catch (e) {\n      return { success: false, message: (e as Error).message };\n    }\n  }\n};"],"names":[],"mappings":";;;;AAUO,MAAM,MAAM;IACjB;;;GAGC,GACD,cAAc,OAAO,QAAgB;QACnC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAE3C,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,KAAK,IAAI;YAEnC,OAAO;gBACL,IAAI,KAAK,EAAE;gBACX,UAAU,QAAQ,SAAS,IAAI;gBAC/B,MAAM,QAAQ,IAAI,IAAI,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;gBACzC,OAAO,QAAQ,KAAK,IAAI;gBACxB,MAAM,QAAQ,IAAI;gBAClB,WAAW,CAAC,iCAAiC,EAAE,QAAQ,KAAK,CAAC,kBAAkB,CAAC;gBAChF,QAAQ,QAAQ,MAAM;gBACtB,OAAO,QAAQ,KAAK;gBACpB,YAAY,IAAI,KAAK,QAAQ,UAAU,EAAE,kBAAkB;YAC7D;QACF,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC,wBAAwB;YACtC,MAAM;QACR;IACF;IAEA;;;GAGC,GACD,WAAW,OAAO,SAAiB,kBAA0B;QAC3D,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,yBAAyB;gBAC/C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,UAAU;oBAAkB,iBAAiB,KAAK,KAAK,CAAC,aAAa;oBAAM,YAAY,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;gBAAC;YACpI;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;gBAAE,SAAS;gBAAO,SAAS,KAAK,KAAK;YAAC;YAE1D,OAAO;gBAAE,SAAS;gBAAM,SAAS,CAAC,yBAAyB,CAAC;gBAAE,aAAa,KAAK,IAAI,CAAC,UAAU;YAAC;QAClG,EAAE,OAAO,GAAG;YACV,OAAO;gBAAE,SAAS;gBAAO,SAAS,AAAC,EAAY,OAAO;YAAC;QACzD;IACF;IAEA;;;GAGC,GACD,eAAe,OAAO,YAAoB;QACxC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,gCAAgC;gBACtD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAW;YACpC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;gBAAE,SAAS;gBAAO,SAAS,KAAK,KAAK;YAAC;YAE1D,OAAO;gBAAE,SAAS;gBAAM,SAAS,CAAC,oBAAoB,EAAE,WAAW,MAAM,CAAC;YAAC;QAC7E,EAAE,OAAO,GAAG;YACV,OAAO;gBAAE,SAAS;gBAAO,SAAS,AAAC,EAAY,OAAO;YAAC;QACzD;IACF;IAEA;;;GAGC,GACD,WAAW,OAAO;QAChB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,sBAAsB;gBAAE,QAAQ;YAAO;YAC/D,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;gBAAE,IAAI;gBAAO,OAAO,KAAK,KAAK;YAAC;YAEnD,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,WAAW,EAAE,KAAK,EAAE,GAAG,KAAK,IAAI;YAE7D,IAAI;YACJ,kFAAkF;YAClF,uCAAuC;YACvC,IAAI,YAAY,UAAU;gBACxB,SAAS;oBACP,IAAI,eAAe;oBACnB,OAAO;oBACP,aAAa,YAAY,aAAa,oBAAoB;oBAC1D,YAAY;oBACZ,QAAQ;oBACR,MAAM,YAAY,aAAa,aAAa;oBAC5C,MAAM;oBACN,UAAU,OAAO,QAAQ;oBACzB,OAAO;gBACT;YACF;YAEA,OAAO;gBACL,IAAI;gBACJ,OAAO;oBAAE,GAAG,KAAK;oBAAE,IAAI,OAAO,MAAM;gBAAU;gBAC9C;gBACA,SAAS,YAAY,WAAW,WAAW;YAC7C;QACF,EAAE,OAAO,GAAG;YACV,OAAO;gBAAE,IAAI;gBAAO,OAAO,AAAC,EAAY,OAAO;YAAC;QAClD;IACF;IAEA;;;GAGC,GACD,cAAc,OAAO,SAAiB;QACpC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,qBAAqB;gBAC3C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAK;YAC9B;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,OAAO,KAAK,EAAE;QAChB,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC;YACd,OAAO;QACT;IACF;IAEA;;;GAGC,GACD,SAAS;QACP,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE;YAEtB,mCAAmC;YACnC,OAAO,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,MAAa,CAAC;oBAClC,IAAI,IAAI,EAAE;oBACV,WAAW,IAAI,KAAK,IAAI,UAAU,EAAE,cAAc;oBAClD,QAAQ,IAAI,QAAQ;oBACpB,UAAU,IAAI,QAAQ,EAAE,QAAQ;oBAChC,YAAY;oBACZ,QAAQ,IAAI,IAAI;oBAChB,SAAS,KAAK,SAAS,CAAC,IAAI,QAAQ;gBACtC,CAAC;QACH,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC;YACd,OAAO,EAAE;QACX;IACF;IAEA;;;GAGC,GACD,aAAa,OAAO;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,2BAA2B;gBACjD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAc;YACvC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,OAAO;gBAAE,SAAS,IAAI,EAAE;gBAAE,SAAS,KAAK,EAAE,GAAG,cAAc,KAAK,KAAK;YAAC;QACxE,EAAE,OAAO,GAAG;YACV,OAAO;gBAAE,SAAS;gBAAO,SAAS,AAAC,EAAY,OAAO;YAAC;QACzD;IACF;AACF"}},
    {"offset": {"line": 445, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/services/store.tsx"],"sourcesContent":["import React, { createContext, useContext, useReducer, ReactNode, useEffect } from 'react';\nimport { User, Reward, PrizeConfig, ActivityLog, AppState, UserRole, SpinResult } from '../types';\nimport { MOCK_REWARDS, MOCK_PRIZES, MOCK_LOGS } from './mockData';\nimport { supabase } from './supabase';\nimport { api } from './api';\n\n// --- Types & Actions ---\ntype Action =\n  | { type: 'SET_USER'; payload: User | null }\n  | { type: 'UPDATE_USER_POINTS'; payload: { points: number; spins: number } }\n  | { type: 'ADD_LOG'; payload: ActivityLog }\n  | { type: 'ADD_REWARD'; payload: Reward }\n  | { type: 'MARK_REWARD_USED'; payload: string }\n  | { type: 'SET_LOADING'; payload: boolean }\n  | { type: 'SET_LOADING'; payload: boolean }\n  | { type: 'CLEAR_NEW_REWARD_FLAG' }\n  | { type: 'SET_LOGS'; payload: ActivityLog[] };\n\ninterface AppContextType {\n  state: AppState & { isLoading: boolean };\n  actions: {\n    logout: () => Promise<void>;\n    grantSpinsByPublicId: (staffId: string, publicId: string, billAmount: number) => Promise<{ success: boolean; message: string }>;\n    earnPoints: (staffId: string, publicId: string, billAmount: number) => Promise<{ success: boolean; message: string }>;\n    convertPointsToSpins: (customerId: string, spinsToBuy: number) => Promise<{ success: boolean; message: string }>;\n    spinWheel: (customerId: string) => Promise<SpinResult>;\n    redeemCoupon: (staffId: string, code: string) => Promise<boolean>;\n    clearNewRewardFlag: () => void;\n    // System Actions\n    setUser: (user: User | null) => void;\n    setLoading: (loading: boolean) => void;\n    setLogs: (logs: ActivityLog[]) => void;\n  };\n}\n\n// --- Initial State ---\nconst initialState: AppState & { isLoading: boolean } = {\n  currentUser: null,\n  activeRole: UserRole.CUSTOMER, // Will be derived from currentUser\n  users: {}, // Only used for lookup cache in this version\n  rewards: MOCK_REWARDS,\n  logs: MOCK_LOGS,\n  prizes: MOCK_PRIZES,\n  lastCreatedRewardId: null,\n  isLoading: true,\n};\n\n// --- Reducer ---\nconst appReducer = (state: AppState & { isLoading: boolean }, action: Action): AppState & { isLoading: boolean } => {\n  const timestamp = new Date().toLocaleString();\n\n  switch (action.type) {\n    case 'SET_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        activeRole: action.payload?.role || UserRole.CUSTOMER,\n        isLoading: false,\n      };\n\n    case 'SET_LOADING':\n      return { ...state, isLoading: action.payload };\n\n    case 'UPDATE_USER_POINTS':\n      if (!state.currentUser) return state;\n      return {\n        ...state,\n        currentUser: {\n          ...state.currentUser,\n          points: action.payload.points,\n          spins: action.payload.spins\n        }\n      };\n\n    case 'ADD_LOG':\n      return { ...state, logs: [action.payload, ...state.logs] };\n\n    case 'ADD_REWARD':\n      return {\n        ...state,\n        rewards: [action.payload, ...state.rewards],\n        lastCreatedRewardId: action.payload.id\n      };\n\n    case 'MARK_REWARD_USED':\n      return {\n        ...state,\n        rewards: state.rewards.map(r => r.code === action.payload ? { ...r, isUsed: true } : r)\n      };\n\n    case 'CLEAR_NEW_REWARD_FLAG':\n      return { ...state, rewards: state.rewards.map(r => ({ ...r, isNew: false })), lastCreatedRewardId: null };\n\n    case 'SET_LOGS':\n      return { ...state, logs: action.payload };\n\n    default:\n      return state;\n  }\n};\n\n// --- Provider ---\nconst AppContext = createContext<AppContextType | undefined>(undefined);\n\nexport const AppProvider = ({ children }: { children: ReactNode }) => {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // --- Auth Listener ---\n  // Moved to AuthProvider to avoid race conditions and improve architecture\n  useEffect(() => {\n    // Initial state is loading\n    // AuthProvider will handle SET_USER and SET_LOADING\n  }, []);\n\n\n  // --- Actions (Async Wrappers around API) ---\n\n  const logout = async () => {\n    await supabase.auth.signOut();\n    dispatch({ type: 'SET_USER', payload: null });\n  };\n\n  const grantSpinsByPublicId = async (staffId: string, publicId: string, billAmount: number) => {\n    // Legacy alias\n    return earnPoints(staffId, publicId, billAmount);\n  };\n\n  const earnPoints = async (staffId: string, publicId: string, billAmount: number) => {\n    const res = await api.addPoints(staffId, publicId, billAmount);\n\n    // Log it\n    if (res.success) {\n      dispatch({\n        type: 'ADD_LOG',\n        payload: {\n          id: `l-${Date.now()}`,\n          timestamp: new Date().toLocaleString(),\n          userId: staffId,\n          userName: 'Staff Member', // simplified for logs\n          userAvatar: '',\n          action: 'EARN_POINTS',\n          details: `Earned ${res.pointsAdded} Points ($${billAmount.toFixed(2)})`,\n          publicId\n        }\n      });\n    }\n    return res;\n  }\n\n  const convertPointsToSpins = async (customerId: string, spinsToBuy: number) => {\n    const res = await api.convertPoints(customerId, spinsToBuy);\n    if (res.success) {\n      // Optimistic update\n      if (state.currentUser) {\n        const currentPoints = state.currentUser.points || 0;\n        const currentSpins = state.currentUser.spins || 0;\n        dispatch({\n          type: 'UPDATE_USER_POINTS',\n          payload: {\n            points: Math.max(0, currentPoints - (spinsToBuy * 100)),\n            spins: currentSpins + spinsToBuy\n          }\n        });\n      }\n      dispatch({\n        type: 'ADD_LOG',\n        payload: {\n          id: `l-${Date.now()}`,\n          timestamp: new Date().toLocaleString(),\n          userId: customerId,\n          userName: state.currentUser?.name || 'Customer',\n          userAvatar: state.currentUser?.avatarUrl || '',\n          action: 'CONVERT_POINTS',\n          details: `Converted points to ${spinsToBuy} Spins`\n        }\n      });\n    }\n    return res;\n  }\n\n  const spinWheel = async (customerId: string): Promise<SpinResult> => {\n    const res = await api.spinWheel(customerId);\n\n    if (res.ok && state.currentUser) {\n      // Optimistic update\n      dispatch({\n        type: 'UPDATE_USER_POINTS',\n        payload: {\n          points: state.currentUser.points || 0,\n          spins: Math.max(0, (state.currentUser.spins || 0) - 1)\n        }\n      });\n\n      if (res.reward) {\n        dispatch({ type: 'ADD_REWARD', payload: { ...res.reward, isNew: true } });\n      }\n\n      dispatch({\n        type: 'ADD_LOG',\n        payload: {\n          id: `l-${Date.now()}`,\n          timestamp: new Date().toLocaleString(),\n          userId: customerId,\n          userName: state.currentUser.name,\n          userAvatar: state.currentUser.avatarUrl,\n          action: 'SPIN',\n          details: `Result: ${res.prize?.name || 'No Win'}`,\n        }\n      });\n    }\n\n    return res as SpinResult;\n  };\n\n  const redeemCoupon = async (staffId: string, code: string): Promise<boolean> => {\n    const success = await api.redeemCoupon(staffId, code);\n    if (success) {\n      dispatch({ type: 'MARK_REWARD_USED', payload: code });\n      dispatch({\n        type: 'ADD_LOG',\n        payload: {\n          id: `l-${Date.now()}`,\n          timestamp: new Date().toLocaleString(),\n          userId: staffId,\n          userName: 'Staff Member',\n          userAvatar: '',\n          action: 'REDEMPTION',\n          details: `Redeemed Coupon: ${code}`,\n        }\n      });\n    }\n    return success;\n  };\n\n  const clearNewRewardFlag = () => dispatch({ type: 'CLEAR_NEW_REWARD_FLAG' });\n\n  // System Actions exposed for AuthProvider\n  const setUser = (user: User | null) => dispatch({ type: 'SET_USER', payload: user });\n  const setLoading = (loading: boolean) => dispatch({ type: 'SET_LOADING', payload: loading });\n  const setLogs = (logs: ActivityLog[]) => dispatch({ type: 'SET_LOGS', payload: logs });\n\n  return (\n    <AppContext.Provider value={{ state, actions: { logout, grantSpinsByPublicId, earnPoints, convertPointsToSpins, spinWheel, redeemCoupon, clearNewRewardFlag, setUser, setLoading, setLogs } }}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\nexport const useAppStore = () => {\n  const context = useContext(AppContext);\n  if (!context) throw new Error('useAppStore must be used within AppProvider');\n  return context;\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 733, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/components/customer/CustomerApp.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { User, Reward, SpinResult, PrizeConfig } from '../../types';\nimport { useAppStore } from '../../services/store';\n\ninterface CustomerProps {\n  user: User;\n  rewards: Reward[];\n  onNavigate: (view: string) => void;\n  currentView: string;\n  onSpin: () => Promise<SpinResult>;\n}\n\n// --- Components ---\n\nconst BottomNav = ({ currentView, onNavigate }: { currentView: string; onNavigate: (v: string) => void }) => {\n  const navItems = [\n    { id: 'home', icon: 'home', label: 'Home' },\n    { id: 'rewards', icon: 'local_activity', label: 'Rewards' },\n    { id: 'profile', icon: 'person', label: 'Profile' },\n  ];\n\n  return (\n    <nav className=\"fixed bottom-0 left-0 right-0 bg-white dark:bg-ocean-900 border-t border-gray-200 dark:border-ocean-800 pb-safe z-50\">\n      <div className=\"flex justify-around items-center h-16 max-w-md mx-auto\">\n        {navItems.map((item) => (\n          <button\n            key={item.id}\n            onClick={() => onNavigate(item.id)}\n            className={`flex flex-col items-center justify-center w-full h-full gap-1 transition-colors ${\n              currentView === item.id ? 'text-gold-400' : 'text-gray-400 hover:text-gray-200'\n            }`}\n          >\n            <span className=\"material-symbols-outlined\">{item.icon}</span>\n            <span className=\"text-[10px] font-medium\">{item.label}</span>\n          </button>\n        ))}\n      </div>\n    </nav>\n  );\n};\n\nconst WheelComponent = ({ \n  isSpinning, \n  prizes, \n  targetPrizeIndex, \n  onSpinEnd \n}: { \n  isSpinning: boolean, \n  prizes: PrizeConfig[], \n  targetPrizeIndex: number | null, \n  onSpinEnd: () => void \n}) => {\n    const [rotation, setRotation] = useState(0);\n    const activePrizes = prizes.filter(p => p.active);\n    const segmentAngle = 360 / activePrizes.length;\n\n    useEffect(() => {\n        if (isSpinning && targetPrizeIndex !== null) {\n            const extraSpins = 360 * 5; \n            const targetRotation = extraSpins + (360 - (targetPrizeIndex * segmentAngle)) - (segmentAngle / 2); \n            const randomOffset = (Math.random() * segmentAngle * 0.8) - (segmentAngle * 0.4);\n\n            setRotation(prev => prev + targetRotation + randomOffset);\n            \n            const timer = setTimeout(() => {\n                onSpinEnd();\n            }, 4000); \n            return () => clearTimeout(timer);\n        }\n    }, [isSpinning, targetPrizeIndex]);\n\n    return (\n        <div className=\"relative aspect-square max-w-[340px] mx-auto mb-10\">\n            <div \n                className=\"w-full h-full rounded-full border-[8px] border-ocean-800 bg-ocean-950 relative shadow-[0_0_60px_rgba(0,0,0,0.5)] overflow-hidden\"\n                style={{\n                    transform: `rotate(${rotation}deg)`,\n                    transition: isSpinning ? 'transform 4s cubic-bezier(0.2, 0.8, 0.2, 1)' : 'none'\n                }}\n            >\n                <div className=\"absolute inset-0 rounded-full overflow-hidden\">\n                    {activePrizes.map((prize, i) => (\n                        <div \n                            key={prize.id}\n                            className=\"absolute top-0 left-0 w-full h-full\"\n                            style={{\n                                transform: `rotate(${i * segmentAngle}deg)`,\n                            }}\n                        >\n                            <div \n                                className=\"absolute top-0 left-1/2 w-full h-full origin-left flex items-center justify-center\"\n                                style={{\n                                    transform: `rotate(${90 - (segmentAngle/2)}deg) skewY(-${90 - segmentAngle}deg)`, \n                                    background: prize.color || '#334155',\n                                }}\n                            >\n                            </div>\n                        </div>\n                    ))}\n                    <div className=\"absolute inset-0 rounded-full\" style={{\n                        background: `conic-gradient(\n                            ${activePrizes.map((p, i) => `${p.color || '#334155'} ${i * (360/activePrizes.length)}deg ${(i+1) * (360/activePrizes.length)}deg`).join(', ')}\n                        )`\n                    }}></div>\n                </div>\n\n                {activePrizes.map((prize, i) => (\n                    <div \n                        key={`icon-${prize.id}`}\n                        className=\"absolute top-0 left-1/2 -translate-x-1/2 w-10 h-1/2 origin-bottom flex flex-col justify-start pt-6 items-center z-10\"\n                        style={{ transform: `rotate(${i * segmentAngle + (segmentAngle/2)}deg)` }}\n                    >\n                        <span className=\"material-symbols-outlined text-white drop-shadow-md text-2xl font-bold\">{prize.icon}</span>\n                        <span className=\"text-[10px] font-bold text-white drop-shadow-md max-w-[60px] text-center leading-tight mt-1\">{prize.name}</span>\n                    </div>\n                ))}\n            </div>\n\n            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 size-20 rounded-full bg-gradient-to-br from-gold-400 to-amber-600 border-[6px] border-ocean-800 shadow-inner z-20 flex items-center justify-center\">\n                <span className=\"material-symbols-outlined text-ocean-950 text-4xl\">stars</span>\n            </div>\n\n            <div className=\"absolute -top-6 left-1/2 -translate-x-1/2 text-white z-30 drop-shadow-[0_4px_4px_rgba(0,0,0,0.5)]\">\n                <span className=\"material-symbols-outlined text-6xl fill-current text-white\">arrow_drop_down</span>\n            </div>\n        </div>\n    );\n};\n\n// --- View: Game Hub ---\nconst GameView = ({ spins, onBack, onSpin }: { spins: number; onBack: () => void; onSpin: () => Promise<SpinResult> }) => {\n    const { state } = useAppStore();\n    const [isSpinning, setIsSpinning] = useState(false);\n    const [targetIndex, setTargetIndex] = useState<number | null>(null);\n    const [result, setResult] = useState<SpinResult | null>(null);\n    const [showModal, setShowModal] = useState(false);\n\n    const activePrizes = state.prizes.filter(p => p.active);\n\n    const handleSpinClick = async () => {\n        if (spins <= 0 || isSpinning) return;\n        \n        const spinResult = await onSpin();\n        if (!spinResult.ok || !spinResult.prize) {\n            alert(spinResult.error || \"Error spinning\");\n            return;\n        }\n\n        const index = activePrizes.findIndex(p => p.id === spinResult.prize?.id);\n        \n        setResult(spinResult);\n        setTargetIndex(index !== -1 ? index : 0);\n        setIsSpinning(true);\n    };\n\n    const handleSpinEnd = () => {\n        setIsSpinning(false);\n        setShowModal(true);\n    };\n\n    const closeModal = () => {\n        setShowModal(false);\n        if (result?.outcome === 'WIN') {\n            onBack(); \n        }\n    };\n\n    return (\n    <div className=\"flex flex-col h-full px-6 pt-6 pb-24 bg-ocean-950\">\n        <button onClick={onBack} disabled={isSpinning} className=\"flex items-center text-slate-400 mb-6 disabled:opacity-50\">\n            <span className=\"material-symbols-outlined\">arrow_back</span> Back\n        </button>\n        \n        <div className=\"text-center mb-8\">\n            <h1 className=\"text-4xl font-black text-white mb-2\">Game Hub</h1>\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 bg-gold-400/10 border border-gold-400/20 rounded-full text-gold-400 font-bold text-sm\">\n                <span className=\"material-symbols-outlined text-lg\">sync</span>\n                REMAINING SPINS: {spins}\n            </div>\n        </div>\n\n        <WheelComponent \n            isSpinning={isSpinning}\n            prizes={activePrizes}\n            targetPrizeIndex={targetIndex}\n            onSpinEnd={handleSpinEnd}\n        />\n\n        <button \n            disabled={spins === 0 || isSpinning} \n            onClick={handleSpinClick}\n            className=\"w-full py-4 bg-gold-400 disabled:opacity-50 disabled:cursor-not-allowed text-ocean-950 font-black text-xl rounded-full shadow-[0_0_30px_rgba(242,166,13,0.3)] hover:shadow-[0_0_50px_rgba(242,166,13,0.5)] transition-all active:scale-95 flex items-center justify-center gap-3\"\n        >\n            <span className={`material-symbols-outlined text-3xl ${isSpinning ? 'animate-spin' : ''}`}>casino</span>\n            {isSpinning ? 'SPINNING...' : (spins > 0 ? 'START SPIN' : 'NO SPINS')}\n        </button>\n\n        {showModal && result && (\n            <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black/90 backdrop-blur-md animate-in fade-in duration-300\">\n                <div className=\"bg-ocean-900 w-full max-w-sm rounded-3xl border border-gold-400/50 p-8 text-center shadow-2xl relative overflow-hidden\">\n                    {result.outcome === 'WIN' && (\n                        <div className=\"absolute inset-0 bg-gold-400/10 animate-pulse\"></div>\n                    )}\n                    \n                    <div className=\"relative z-10\">\n                        <div className=\"size-20 bg-ocean-800 rounded-full mx-auto mb-4 flex items-center justify-center border-4 border-ocean-700\">\n                             <span className=\"material-symbols-outlined text-5xl text-gold-400\">\n                                {result.prize?.icon || 'stars'}\n                             </span>\n                        </div>\n\n                        <h2 className=\"text-2xl font-black text-white mb-2 uppercase italic\">\n                            {result.outcome === 'WIN' ? 'You Won!' : 'So Close!'}\n                        </h2>\n                        <p className=\"text-lg text-gold-400 font-bold mb-6\">{result.prize?.name}</p>\n\n                        {result.outcome === 'WIN' && (\n                            <p className=\"text-slate-400 text-sm mb-8\">This reward has been added to your wallet.</p>\n                        )}\n                        \n                        <button \n                            onClick={closeModal}\n                            className=\"w-full py-3 bg-white text-ocean-950 font-bold rounded-xl hover:bg-gray-100 transition-colors\"\n                        >\n                            {result.outcome === 'WIN' ? 'Awesome!' : 'Try Again'}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        )}\n    </div>\n    );\n};\n\n// --- View: Home ---\nconst HomeView = ({ onPlayGame }: { onPlayGame: () => void }) => (\n  <div className=\"px-6 pt-6 pb-24\">\n    <div className=\"flex justify-between items-end mb-6\">\n      <div>\n        <h2 className=\"text-2xl font-bold text-white\">Active <span className=\"text-gold-400\">Events</span></h2>\n        <p className=\"text-slate-400 text-sm mt-1\">Play, dine, and earn rewards</p>\n      </div>\n    </div>\n    <div className=\"flex overflow-x-auto no-scrollbar snap-x snap-mandatory gap-5 pb-8 -mx-6 px-6\">\n      <div className=\"relative flex-none w-[85%] snap-center rounded-3xl overflow-hidden aspect-[4/5] bg-ocean-800 border border-gold-400/30 shadow-[0_0_25px_rgba(242,166,13,0.15)] group\">\n        <div className=\"absolute inset-0 p-7 flex flex-col justify-between z-10\">\n          <div>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <span className=\"px-2 py-1 rounded text-[10px] font-bold bg-gold-400 text-ocean-950 uppercase\">Daily</span>\n              <span className=\"px-2 py-1 rounded text-[10px] font-bold bg-white/10 text-white uppercase border border-white/10\">Game</span>\n            </div>\n            <h3 className=\"text-3xl font-bold text-white leading-tight mb-2\">Lucky Wheel<br /><span className=\"text-gold-400 italic\">1.0</span></h3>\n            <p className=\"text-slate-400 text-sm\">Spin for a chance to win exclusive Wagyu upgrades.</p>\n          </div>\n          <div className=\"flex flex-col items-center gap-6 mt-auto\">\n            <span className=\"material-symbols-outlined text-7xl text-gold-400 drop-shadow-[0_0_15px_rgba(242,166,13,0.6)]\">cyclone</span>\n            <button \n              onClick={onPlayGame}\n              className=\"w-full py-4 bg-gold-400 hover:bg-gold-500 text-ocean-950 font-bold text-lg rounded-xl shadow-lg shadow-gold-400/20 transition-all active:scale-95 flex items-center justify-center gap-2\"\n            >\n              <span className=\"material-symbols-outlined\">play_circle</span>\n              Go Spin\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\n// --- View: Rewards ---\nconst RewardsView = ({ rewards, points }: { rewards: Reward[]; points: number }) => {\n    const [selectedReward, setSelectedReward] = useState<Reward | null>(null);\n    const { actions } = useAppStore();\n\n    useEffect(() => {\n        return () => { actions.clearNewRewardFlag(); }\n    }, []);\n\n    return (\n        <div className=\"px-6 pt-8 pb-24\">\n            <h1 className=\"text-3xl font-black text-white mb-2\">My Rewards</h1>\n            <div className=\"flex items-center gap-2 text-slate-400 mb-8\">\n                <span className=\"material-symbols-outlined text-gold-400\">account_balance_wallet</span>\n                <span>Balance: <strong className=\"text-white\">{points.toLocaleString()} Points</strong></span>\n            </div>\n            \n            <div className=\"flex border-b border-ocean-700 mb-6\">\n                <button className=\"pb-3 text-gold-400 font-bold text-sm border-b-2 border-gold-400 flex-1\">Available</button>\n                <button className=\"pb-3 text-slate-500 font-medium text-sm flex-1\">History</button>\n            </div>\n\n            <div className=\"grid gap-4\">\n                {rewards.filter(r => !r.isUsed).length === 0 && (\n                    <div className=\"text-slate-500 text-center py-10\">No available rewards. Go spin!</div>\n                )}\n                {rewards.filter(r => !r.isUsed).map(reward => (\n                    <div key={reward.id} onClick={() => setSelectedReward(reward)} className={`relative bg-ocean-800 rounded-xl overflow-hidden border active:scale-[0.98] transition-transform cursor-pointer ${reward.isNew ? 'border-gold-400 ring-2 ring-gold-400/30' : 'border-ocean-700'}`}>\n                        {reward.isNew && (\n                            <div className=\"absolute top-0 right-0 bg-gold-400 text-ocean-950 text-[10px] font-bold px-2 py-1 rounded-bl-lg z-20 uppercase tracking-wide\">\n                                Just Won\n                            </div>\n                        )}\n                        <div className=\"h-32 bg-cover bg-center relative\" style={{ backgroundImage: `url(${reward.imageUrl})` }}>\n                            <div className=\"absolute top-2 left-2 bg-black/60 backdrop-blur-sm px-2 py-1 rounded-md text-[10px] font-bold text-white border border-white/10\">\n                                {reward.expiryDate}\n                            </div>\n                        </div>\n                        <div className=\"p-4\">\n                            <h3 className=\"font-bold text-white text-lg\">{reward.title}</h3>\n                            <p className=\"text-slate-400 text-sm mt-1 mb-4 line-clamp-2\">{reward.description}</p>\n                            <button className=\"w-full py-2 bg-gold-400 text-ocean-950 font-bold text-sm rounded-lg\">Use Reward</button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {selectedReward && (\n                <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm\">\n                    <div className=\"bg-ocean-900 w-full max-w-sm rounded-2xl border border-ocean-700 overflow-hidden relative animate-in fade-in zoom-in duration-200\">\n                        <button onClick={() => setSelectedReward(null)} className=\"absolute top-4 right-4 p-2 bg-black/20 rounded-full text-white z-10\">\n                            <span className=\"material-symbols-outlined\">close</span>\n                        </button>\n                        <div className=\"h-40 bg-cover bg-center\" style={{ backgroundImage: `url(${selectedReward.imageUrl})` }}></div>\n                        <div className=\"p-6 text-center\">\n                            <h3 className=\"text-xl font-bold text-white mb-1\">{selectedReward.title}</h3>\n                            <p className=\"text-slate-400 text-xs mb-6\">Show this code to server</p>\n                            <div className=\"bg-white p-4 rounded-xl mb-4 inline-block\">\n                                <span className=\"material-symbols-outlined text-8xl text-black\">qr_code_2</span>\n                            </div>\n                            <p className=\"text-2xl font-mono font-bold text-white tracking-widest mb-6\">{selectedReward.code}</p>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\n// --- View: Profile ---\nconst ProfileView = ({ user }: { user: User }) => {\n    const { actions } = useAppStore();\n    const [pointsToConvert, setPointsToConvert] = useState(100);\n\n    const handleConvert = async (spins: number) => {\n        const result = await actions.convertPointsToSpins(user.id, spins);\n        if (result.success) {\n            alert(result.message);\n        } else {\n            alert(result.message);\n        }\n    };\n\n    return (\n    <div className=\"px-6 pt-12 pb-24\">\n        <div className=\"flex items-center gap-4 mb-8\">\n            <div className=\"size-20 rounded-full bg-cover bg-center border-4 border-ocean-700\" style={{ backgroundImage: `url(${user.avatarUrl})` }}></div>\n            <div>\n                <h1 className=\"text-2xl font-bold text-white\">{user.name}</h1>\n                <p className=\"text-slate-400 text-sm\">{user.email}</p>\n                <span className=\"inline-block mt-1 px-2 py-0.5 bg-blue-500/20 text-blue-400 text-[10px] font-bold uppercase rounded\">Member since {user.joinedDate}</span>\n            </div>\n        </div>\n\n        {/* Public ID Card (QR Placeholder) */}\n        <div className=\"bg-white rounded-xl p-6 mb-8 text-ocean-950 shadow-lg text-center relative overflow-hidden group\">\n            <p className=\"text-xs font-bold uppercase tracking-widest text-slate-500 mb-4\">My Member ID</p>\n            <div className=\"bg-white p-2 rounded-xl inline-block mx-auto border-4 border-ocean-950 mb-2\">\n                 <span className=\"material-symbols-outlined text-9xl text-ocean-950\">qr_code_2</span>\n            </div>\n            <p className=\"text-4xl font-mono font-black tracking-wider text-ocean-900\">{user.publicId}</p>\n            <p className=\"text-[10px] font-medium mt-2 text-slate-500\">Show to staff to earn points</p>\n        </div>\n\n        {/* Stats */}\n        <div className=\"bg-ocean-800 rounded-xl p-4 flex justify-between items-center mb-8 border border-ocean-700\">\n             <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 bg-blue-500/10 rounded-lg text-blue-400\">\n                    <span className=\"material-symbols-outlined\">casino</span>\n                </div>\n                <div>\n                    <p className=\"text-xs text-slate-400 uppercase font-bold\">Spins</p>\n                    <p className=\"text-xl font-bold text-white\">{user.spins}</p>\n                </div>\n            </div>\n             <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 bg-gold-400/10 rounded-lg text-gold-400\">\n                    <span className=\"material-symbols-outlined\">stars</span>\n                </div>\n                <div>\n                    <p className=\"text-xs text-slate-400 uppercase font-bold\">Points</p>\n                    <p className=\"text-xl font-bold text-white\">{user.points}</p>\n                </div>\n            </div>\n        </div>\n\n        {/* Conversion UI */}\n        <div className=\"bg-gradient-to-br from-ocean-800 to-ocean-900 rounded-xl p-6 mb-8 border border-gold-400/20 shadow-[0_0_15px_rgba(242,166,13,0.1)]\">\n            <h3 className=\"text-lg font-bold text-white mb-2 flex items-center gap-2\">\n                <span className=\"material-symbols-outlined text-gold-400\">swap_horiz</span>\n                Convert Points\n            </h3>\n            <p className=\"text-xs text-slate-400 mb-4\">100 Points = 1 Lucky Spin</p>\n            \n            <div className=\"grid grid-cols-2 gap-3\">\n                <button \n                    onClick={() => handleConvert(1)}\n                    disabled={(user.points || 0) < 100}\n                    className=\"flex flex-col items-center justify-center p-3 rounded-xl bg-ocean-700 hover:bg-ocean-600 disabled:opacity-50 disabled:hover:bg-ocean-700 border border-ocean-600 transition-colors\"\n                >\n                    <span className=\"text-white font-bold\">1 Spin</span>\n                    <span className=\"text-[10px] text-gold-400 font-bold\">100 pts</span>\n                </button>\n                <button \n                    onClick={() => handleConvert(5)}\n                    disabled={(user.points || 0) < 500}\n                    className=\"flex flex-col items-center justify-center p-3 rounded-xl bg-ocean-700 hover:bg-ocean-600 disabled:opacity-50 disabled:hover:bg-ocean-700 border border-ocean-600 transition-colors\"\n                >\n                    <span className=\"text-white font-bold\">5 Spins</span>\n                    <span className=\"text-[10px] text-gold-400 font-bold\">500 pts</span>\n                </button>\n            </div>\n        </div>\n        \n        <div className=\"space-y-2\">\n            <button className=\"w-full flex items-center justify-between p-4 bg-ocean-800/50 hover:bg-ocean-800 rounded-xl text-white text-sm font-medium transition-colors border border-transparent hover:border-ocean-700\">\n                <span>Log Out</span>\n                <span className=\"material-symbols-outlined text-slate-500\">logout</span>\n            </button>\n        </div>\n    </div>\n    );\n}\n\n\nexport const CustomerApp: React.FC<CustomerProps> = ({ user, rewards, onNavigate, currentView, onSpin }) => {\n  return (\n    <div className=\"min-h-screen bg-ocean-950 font-sans text-slate-200 relative max-w-md mx-auto shadow-2xl overflow-hidden\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-40 bg-ocean-900/80 backdrop-blur-md border-b border-ocean-800 px-5 py-3 flex justify-between items-center\">\n        <div className=\"flex items-center gap-2\">\n            <span className=\"material-symbols-outlined text-gold-400\">water_drop</span>\n            <span className=\"font-bold text-white uppercase tracking-wider text-sm\">Ocean Sumria</span>\n        </div>\n        <div className=\"flex items-center gap-3\">\n            <div className=\"size-8 rounded-full bg-cover bg-center border border-ocean-700\" style={{ backgroundImage: `url(${user.avatarUrl})` }}></div>\n        </div>\n      </header>\n\n      {/* Dynamic Content */}\n      <main className=\"min-h-[calc(100vh-130px)]\">\n        {currentView === 'home' && <HomeView onPlayGame={() => onNavigate('game')} />}\n        {currentView === 'game' && <GameView spins={user.spins || 0} onBack={() => onNavigate('home')} onSpin={onSpin} />}\n        {currentView === 'rewards' && <RewardsView rewards={rewards} points={user.points || 0} />}\n        {currentView === 'profile' && <ProfileView user={user} />}\n      </main>\n\n      <BottomNav currentView={currentView === 'game' ? 'home' : currentView} onNavigate={onNavigate} />\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2113, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/components/staff/StaffApp.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { User } from '../../types';\nimport { useAppStore } from '../../services/store';\n\ninterface StaffProps {\n  user: User;\n  onGrantSpins: (customerId: string, billAmount: number) => { success: boolean; message: string };\n  onRedeemCoupon: (code: string) => boolean;\n}\n\n// --- Internal Component: QR Scanner Modal ---\nconst QRScannerModal = ({ onClose, onScan, type }: { onClose: () => void, onScan: (val: string) => void, type: 'customer' | 'coupon' }) => {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let stream: MediaStream | null = null;\n    let timer: ReturnType<typeof setTimeout>;\n\n    const startCamera = async () => {\n      try {\n        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n        if (videoRef.current) {\n            videoRef.current.srcObject = stream;\n            videoRef.current.play();\n        }\n        \n        // --- DEMO SIMULATION ---\n        // In a real app, we would pipe frames to a QR decoder library (e.g. jsQR).\n        // For this demo, we simulate a successful scan after 2.5 seconds to ensure the reviewer\n        // gets a \"Happy Path\" experience without needing to generate/hold up a real QR code.\n        timer = setTimeout(() => {\n            // Mock data based on scan type\n            const mockValue = type === 'customer' ? 'OS-8X29' : 'XC-992-00';\n            // Vibrate if supported\n            if (navigator.vibrate) navigator.vibrate(200);\n            onScan(mockValue);\n        }, 2500);\n\n      } catch (err) {\n        console.error(\"Camera error\", err);\n        setError(\"Camera access denied or unavailable. Simulating scan...\");\n        // Fallback simulation\n        timer = setTimeout(() => {\n             const mockValue = type === 'customer' ? 'OS-8X29' : 'XC-992-00';\n            onScan(mockValue);\n        }, 1500);\n      }\n    };\n\n    startCamera();\n\n    return () => {\n        if (stream) stream.getTracks().forEach(t => t.stop());\n        clearTimeout(timer);\n    };\n  }, [onScan, type]);\n\n  return (\n    <div className=\"fixed inset-0 z-[60] bg-black text-white flex flex-col\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center p-4 bg-black/50 absolute top-0 left-0 right-0 z-10 backdrop-blur-sm\">\n            <h3 className=\"font-bold text-lg flex items-center gap-2\">\n                <span className=\"material-symbols-outlined text-gold-400\">qr_code_scanner</span>\n                Scanning {type === 'customer' ? 'Customer' : 'Coupon'}\n            </h3>\n            <button onClick={onClose} className=\"p-2 bg-white/10 rounded-full\">\n                <span className=\"material-symbols-outlined\">close</span>\n            </button>\n        </div>\n\n        {/* Camera View */}\n        <div className=\"flex-1 relative overflow-hidden bg-slate-900 flex items-center justify-center\">\n            {!error ? (\n                <video \n                    ref={videoRef} \n                    className=\"absolute inset-0 w-full h-full object-cover\" \n                    playsInline \n                    muted\n                />\n            ) : (\n                <div className=\"text-center p-6 text-slate-400\">\n                    <span className=\"material-symbols-outlined text-4xl mb-2\">videocam_off</span>\n                    <p>{error}</p>\n                </div>\n            )}\n            \n            {/* Overlay / Reticle */}\n            <div className=\"absolute inset-0 flex items-center justify-center p-10 pointer-events-none\">\n                <div className=\"w-64 h-64 border-2 border-gold-400/50 rounded-xl relative\">\n                    {/* Corners */}\n                    <div className=\"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-gold-400 -mt-1 -ml-1 rounded-tl-lg\"></div>\n                    <div className=\"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-gold-400 -mt-1 -mr-1 rounded-tr-lg\"></div>\n                    <div className=\"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-gold-400 -mb-1 -ml-1 rounded-bl-lg\"></div>\n                    <div className=\"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-gold-400 -mb-1 -mr-1 rounded-br-lg\"></div>\n                    \n                    {/* Scanning Line Animation */}\n                    <div className=\"absolute left-2 right-2 h-0.5 bg-gold-400 shadow-[0_0_10px_#f2a60d] animate-[bounce_2s_infinite]\"></div>\n                </div>\n            </div>\n\n            <p className=\"absolute bottom-20 left-0 right-0 text-center text-sm font-medium text-white/80 drop-shadow-md\">\n                Align QR code within the frame\n            </p>\n        </div>\n    </div>\n  );\n};\n\nexport const StaffApp: React.FC<StaffProps> = ({ user, onGrantSpins, onRedeemCoupon }) => {\n  const { state, actions } = useAppStore(); // Access store directly for lookup logic\n  const [activeTab, setActiveTab] = useState<'loyalty' | 'redeem'>('loyalty');\n  \n  // Loyalty Tab State\n  const [lookupId, setLookupId] = useState('OS-8X29');\n  const [loadedUser, setLoadedUser] = useState<User | null>(null);\n  const [billAmount, setBillAmount] = useState<string>('');\n  \n  // Redeem Tab State\n  const [couponCode, setCouponCode] = useState('');\n  \n  const [lastAction, setLastAction] = useState<{msg: string, type: 'success' | 'error'} | null>(null);\n\n  // Scanner State\n  const [showScanner, setShowScanner] = useState(false);\n  const [scanType, setScanType] = useState<'customer' | 'coupon'>('customer');\n\n  const handleLookup = () => {\n      const found = Object.values(state.users).find(u => u.publicId === lookupId.trim());\n      if (found && found.role === 'CUSTOMER') {\n          setLoadedUser(found);\n          setLastAction(null);\n      } else {\n          setLoadedUser(null);\n          setLastAction({ msg: 'Customer not found', type: 'error' });\n      }\n  };\n\n  const handleAddPoints = async () => {\n      if (!loadedUser) return;\n      const amount = parseFloat(billAmount);\n      if (isNaN(amount) || amount <= 0) {\n          setLastAction({ msg: 'Invalid bill amount', type: 'error' });\n          return;\n      }\n      \n      const result = await actions.earnPoints(user.id, loadedUser.publicId, amount);\n      if (result.success) {\n          setLastAction({ msg: result.message, type: 'success' });\n          setBillAmount('');\n          // Refresh loaded user data to show new points instantly\n          const updated = Object.values(state.users).find(u => u.publicId === lookupId.trim());\n          if (updated) setLoadedUser(updated);\n      } else {\n          setLastAction({ msg: result.message, type: 'error' });\n      }\n  };\n\n  const handleRedeem = () => {\n    if (!couponCode) return;\n    const confirm = window.confirm(`Irreversibly redeem coupon ${couponCode}?`);\n    if (confirm) {\n        const success = onRedeemCoupon(couponCode);\n        if (success) {\n            setLastAction({ msg: `Redeemed coupon ${couponCode}`, type: 'success' });\n            setCouponCode('');\n        } else {\n            setLastAction({ msg: \"Coupon invalid or already used\", type: 'error' });\n        }\n    }\n  };\n\n  const startScan = (type: 'customer' | 'coupon') => {\n      setScanType(type);\n      setShowScanner(true);\n  };\n\n  const handleScanResult = (result: string) => {\n      setShowScanner(false);\n      if (scanType === 'customer') {\n          setLookupId(result);\n          // Auto trigger lookup after short delay to let state update\n          setTimeout(() => {\n             const found = Object.values(state.users).find(u => u.publicId === result.trim());\n             if (found && found.role === 'CUSTOMER') {\n                 setLoadedUser(found);\n                 setLastAction({ msg: `Found ${found.name}`, type: 'success' });\n             } else {\n                 setLoadedUser(null);\n                 setLastAction({ msg: `Customer ID ${result} not found`, type: 'error' });\n             }\n          }, 100);\n      } else {\n          setCouponCode(result);\n          setLastAction({ msg: 'Code scanned. Tap \"Verify & Redeem\" to confirm.', type: 'success' });\n      }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background-light dark:bg-background-dark font-sans text-slate-900 dark:text-white flex flex-col\">\n       \n       {showScanner && (\n           <QRScannerModal \n                type={scanType} \n                onClose={() => setShowScanner(false)} \n                onScan={handleScanResult} \n           />\n       )}\n\n       <div className=\"flex-grow flex justify-center items-start p-4 md:p-10\">\n          <div className=\"w-full max-w-[420px] bg-white dark:bg-surface-dark rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden flex flex-col\">\n            \n            <header className=\"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700\">\n                <div className=\"flex items-center gap-3\">\n                    <div className=\"flex items-center justify-center size-8 bg-blue-100 text-blue-600 rounded-lg\">\n                        <span className=\"material-symbols-outlined\">admin_panel_settings</span>\n                    </div>\n                    <h2 className=\"text-lg font-bold\">Staff Portal</h2>\n                </div>\n                <div className=\"size-8 rounded-full bg-cover bg-center\" style={{ backgroundImage: `url(${user.avatarUrl})` }}></div>\n            </header>\n\n            <div className=\"px-6 pt-6 pb-2\">\n                <div className=\"flex p-1 bg-slate-100 dark:bg-slate-700 rounded-xl\">\n                    <button \n                        onClick={() => { setActiveTab('loyalty'); setLastAction(null); }}\n                        className={`flex-1 py-2.5 px-3 rounded-lg text-sm font-semibold transition-all ${activeTab === 'loyalty' ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500'}`}\n                    >\n                        Add Points\n                    </button>\n                    <button \n                         onClick={() => { setActiveTab('redeem'); setLastAction(null); }}\n                         className={`flex-1 py-2.5 px-3 rounded-lg text-sm font-semibold transition-all ${activeTab === 'redeem' ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500'}`}\n                    >\n                        Redeem\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"px-6 py-6 flex flex-col gap-6\">\n                \n                {activeTab === 'loyalty' && (\n                    <>\n                        <div className=\"text-center\">\n                            <h1 className=\"text-2xl font-bold\">Customer Loyalty</h1>\n                            <p className=\"text-sm text-slate-500 mt-1\">Look up customer to add points.</p>\n                        </div>\n\n                        {/* Lookup Section */}\n                        <div className=\"flex gap-2\">\n                            <div className=\"relative flex-1\">\n                                <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\">\n                                    <span className=\"material-symbols-outlined text-[20px]\">id_card</span>\n                                </span>\n                                <input \n                                    type=\"text\" \n                                    placeholder=\"Customer ID\"\n                                    value={lookupId}\n                                    onChange={(e) => setLookupId(e.target.value.toUpperCase())}\n                                    className=\"w-full pl-10 pr-3 py-3 bg-slate-50 border border-slate-200 rounded-xl font-bold focus:ring-2 focus:ring-blue-600 outline-none uppercase text-slate-900\"\n                                />\n                            </div>\n                            <button \n                                onClick={() => startScan('customer')}\n                                className=\"bg-slate-100 hover:bg-slate-200 text-slate-700 px-3 rounded-xl border border-slate-200\"\n                            >\n                                <span className=\"material-symbols-outlined\">qr_code_scanner</span>\n                            </button>\n                            <button onClick={handleLookup} className=\"bg-slate-900 text-white px-4 rounded-xl font-bold text-sm\">Find</button>\n                        </div>\n\n                        {loadedUser && (\n                            <div className=\"bg-slate-50 border border-slate-200 rounded-xl p-4 animate-in fade-in slide-in-from-top-4\">\n                                <div className=\"flex items-center gap-3 mb-4\">\n                                    <div className=\"size-10 rounded-full bg-cover bg-center\" style={{ backgroundImage: `url(${loadedUser.avatarUrl})` }}></div>\n                                    <div>\n                                        <p className=\"font-bold text-slate-900\">{loadedUser.name}</p>\n                                        <p className=\"text-xs text-slate-500 font-mono\">{loadedUser.publicId}</p>\n                                    </div>\n                                    <div className=\"ml-auto text-right\">\n                                        <p className=\"text-lg font-bold text-gold-500\">{loadedUser.points} pts</p>\n                                        <p className=\"text-xs text-slate-400\">{loadedUser.spins} spins</p>\n                                    </div>\n                                </div>\n                                \n                                <div className=\"border-t border-slate-200 pt-4\">\n                                    <label className=\"block text-xs font-bold text-slate-500 uppercase mb-2\">Bill Amount</label>\n                                    <div className=\"flex gap-2\">\n                                        <div className=\"relative flex-1\">\n                                            <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-bold\">$</span>\n                                            <input \n                                                type=\"number\" \n                                                value={billAmount}\n                                                onChange={(e) => setBillAmount(e.target.value)}\n                                                placeholder=\"0.00\"\n                                                className=\"w-full pl-7 pr-3 py-2 bg-white border border-slate-300 rounded-lg font-bold text-lg focus:ring-2 focus:ring-blue-600 outline-none text-slate-900\"\n                                            />\n                                        </div>\n                                        <button \n                                            onClick={handleAddPoints}\n                                            disabled={!billAmount} \n                                            className=\"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-1\"\n                                        >\n                                            <span className=\"material-symbols-outlined text-sm\">add</span>\n                                            {Math.floor(parseFloat(billAmount) || 0)} Pts\n                                        </button>\n                                    </div>\n                                    <p className=\"text-[10px] text-slate-400 mt-2\">$1.00 = 1 Point</p>\n                                </div>\n                            </div>\n                        )}\n                    </>\n                )}\n\n                {activeTab === 'redeem' && (\n                    <>\n                         <div className=\"text-center\">\n                            <h1 className=\"text-2xl font-bold\">Redeem Coupon</h1>\n                            <p className=\"text-sm text-slate-500 mt-1\">Scan customer QR or enter code.</p>\n                        </div>\n\n                        <button \n                            onClick={() => startScan('coupon')}\n                            className=\"w-full aspect-[4/2] bg-slate-50 border-2 border-dashed border-slate-300 rounded-2xl flex flex-col items-center justify-center gap-3 hover:border-blue-600 hover:bg-blue-50 transition-all cursor-pointer\"\n                        >\n                             <div className=\"size-16 bg-white rounded-full shadow-sm flex items-center justify-center\">\n                                <span className=\"material-symbols-outlined text-3xl text-blue-600\">qr_code_scanner</span>\n                            </div>\n                            <span className=\"text-sm font-semibold text-slate-600\">Tap to Scan Camera</span>\n                        </button>\n\n                        <div className=\"relative\">\n                            <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\">\n                                <span className=\"material-symbols-outlined text-[20px]\">confirmation_number</span>\n                            </span>\n                            <input \n                                type=\"text\" \n                                placeholder=\"ENTER COUPON CODE\"\n                                value={couponCode}\n                                onChange={(e) => setCouponCode(e.target.value.toUpperCase())}\n                                className=\"w-full pl-11 pr-4 py-3.5 bg-white border border-slate-300 rounded-xl text-base font-medium focus:ring-2 focus:ring-blue-600 outline-none uppercase\"\n                            />\n                        </div>\n\n                        <button \n                            onClick={handleRedeem}\n                            disabled={!couponCode}\n                            className=\"w-full bg-slate-900 text-white font-bold text-lg py-3.5 rounded-xl shadow-lg hover:opacity-90 transition-all disabled:opacity-50\"\n                        >\n                            Verify & Redeem\n                        </button>\n                    </>\n                )}\n\n                {/* Toast/Notification area */}\n                {lastAction && (\n                    <div className={`border p-3 rounded-lg text-sm flex items-center gap-2 animate-bounce ${lastAction.type === 'success' ? 'bg-green-100 border-green-200 text-green-800' : 'bg-red-100 border-red-200 text-red-800'}`}>\n                        <span className=\"material-symbols-outlined\">{lastAction.type === 'success' ? 'check_circle' : 'error'}</span>\n                        {lastAction.msg}\n                    </div>\n                )}\n            </div>\n          </div>\n       </div>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2988, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/components/admin/AdminApp.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { User, PrizeConfig, ActivityLog, Reward } from '../../types';\n\ninterface AdminProps {\n  user: User;\n  prizes: PrizeConfig[];\n  logs: ActivityLog[];\n  rewards: Reward[];\n}\n\nexport const AdminApp: React.FC<AdminProps> = ({ user, prizes, logs, rewards }) => {\n  const [activeTab, setActiveTab] = useState<'dashboard' | 'prizes' | 'logs'>('dashboard');\n  const [activeLogType, setActiveLogType] = useState<'SPIN' | 'REDEMPTION' | 'EARN_POINTS'>('SPIN');\n\n  // --- KPI Calculations (Simple \"All Time\" for Mock) ---\n  const pointsEarned = logs.filter(l => l.action === 'EARN_POINTS').reduce((acc, l) => {\n    const match = l.details.match(/Earned (\\d+)/);\n    return acc + (match ? parseInt(match[1]) : 0);\n  }, 0);\n\n  const pointsConverted = logs.filter(l => l.action === 'CONVERT_POINTS').reduce((acc, l) => {\n      const match = l.details.match(/Converted (\\d+)/);\n      return acc + (match ? parseInt(match[1]) : 0);\n  }, 0);\n\n  const spinsUsed = logs.filter(l => l.action === 'SPIN').length;\n  const couponsRedeemed = rewards.filter(r => r.isUsed).length;\n  \n  // Find top prize (most common title in logs)\n  const prizeCounts: Record<string, number> = {};\n  logs.filter(l => l.action === 'SPIN').forEach(l => {\n    const title = l.details.replace('Result: ', '');\n    prizeCounts[title] = (prizeCounts[title] || 0) + 1;\n  });\n  const topPrize = Object.entries(prizeCounts).sort((a, b) => b[1] - a[1])[0]?.[0] || 'None';\n\n  const renderActionBadge = (action: string, details: string) => {\n    if (action === 'SPIN') {\n      return (\n        <div className=\"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-green-50 border border-green-100\">\n           <span className=\"size-1.5 rounded-full bg-green-500\"></span>\n           <span className=\"text-xs font-medium text-green-700\">{details}</span>\n        </div>\n      );\n    }\n    if (action === 'REDEMPTION') {\n        return (\n            <div className=\"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-blue-50 border border-blue-100\">\n               <span className=\"size-1.5 rounded-full bg-blue-500\"></span>\n               <span className=\"text-xs font-medium text-blue-700\">{details}</span>\n            </div>\n        );\n    }\n    if (action === 'EARN_POINTS') {\n        return (\n            <div className=\"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-yellow-50 border border-yellow-100\">\n               <span className=\"size-1.5 rounded-full bg-yellow-500\"></span>\n               <span className=\"text-xs font-medium text-yellow-700\">{details}</span>\n            </div>\n        );\n    }\n    if (action === 'CONVERT_POINTS') {\n        return (\n            <div className=\"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-indigo-50 border border-indigo-100\">\n               <span className=\"size-1.5 rounded-full bg-indigo-500\"></span>\n               <span className=\"text-xs font-medium text-indigo-700\">{details}</span>\n            </div>\n        );\n    }\n    return (\n        <div className=\"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-purple-50 border border-purple-100\">\n           <span className=\"size-1.5 rounded-full bg-purple-500\"></span>\n           <span className=\"text-xs font-medium text-purple-700\">{details}</span>\n        </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 font-sans text-slate-900 flex\">\n      {/* Sidebar */}\n      <aside className=\"w-64 bg-white border-r border-slate-200 hidden lg:flex flex-col\">\n        <div className=\"p-6 flex items-center gap-3\">\n             <div className=\"size-8 bg-gold-400 rounded-lg flex items-center justify-center text-white font-bold\">OS</div>\n             <span className=\"font-bold text-slate-800\">Admin Console</span>\n        </div>\n        <nav className=\"flex-1 px-4 py-4 space-y-1\">\n            <button \n                onClick={() => setActiveTab('dashboard')}\n                className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${activeTab === 'dashboard' ? 'bg-blue-50 text-blue-700' : 'text-slate-600 hover:bg-slate-50'}`}\n            >\n                <span className=\"material-symbols-outlined\">dashboard</span>\n                Dashboard\n            </button>\n            <button \n                onClick={() => setActiveTab('prizes')}\n                className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${activeTab === 'prizes' ? 'bg-blue-50 text-blue-700' : 'text-slate-600 hover:bg-slate-50'}`}\n            >\n                <span className=\"material-symbols-outlined\">redeem</span>\n                Prize Config\n            </button>\n            <button \n                 onClick={() => setActiveTab('logs')}\n                 className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${activeTab === 'logs' ? 'bg-blue-50 text-blue-700' : 'text-slate-600 hover:bg-slate-50'}`}\n            >\n                <span className=\"material-symbols-outlined\">description</span>\n                Activity Logs\n            </button>\n        </nav>\n        <div className=\"p-4 border-t border-slate-200\">\n             <div className=\"flex items-center gap-3\">\n                <img src={user.avatarUrl} className=\"size-8 rounded-full\" alt=\"Admin\" />\n                <div className=\"text-xs\">\n                    <p className=\"font-bold text-slate-900\">{user.name}</p>\n                    <p className=\"text-slate-500\">Manager</p>\n                </div>\n             </div>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"flex-1 flex flex-col h-screen overflow-hidden\">\n        {/* Mobile Header */}\n        <header className=\"bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 lg:px-8 shrink-0\">\n            <h1 className=\"text-xl font-bold flex items-center gap-2\">\n                <span className=\"lg:hidden material-symbols-outlined\">menu</span>\n                <span className=\"uppercase\">{activeTab}</span>\n            </h1>\n            <div className=\"flex gap-2\">\n                 {activeTab === 'prizes' && (\n                     <>\n                        <button className=\"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg\">Discard</button>\n                        <button className=\"px-4 py-2 text-sm font-bold bg-gold-400 hover:bg-gold-500 text-white rounded-lg shadow-sm\">Publish Live</button>\n                     </>\n                 )}\n            </div>\n        </header>\n\n        <div className=\"flex-1 overflow-y-auto p-6 lg:p-8\">\n            \n            {/* --- DASHBOARD VIEW --- */}\n            {activeTab === 'dashboard' && (\n                <div className=\"max-w-6xl mx-auto space-y-6\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                        <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                            <p className=\"text-slate-500 text-sm font-bold uppercase\">Points Earned</p>\n                            <p className=\"text-3xl font-black text-slate-900 mt-2\">{pointsEarned}</p>\n                        </div>\n                        <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                            <p className=\"text-slate-500 text-sm font-bold uppercase\">Points Converted</p>\n                            <p className=\"text-3xl font-black text-slate-900 mt-2\">{pointsConverted}</p>\n                        </div>\n                        <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                            <p className=\"text-slate-500 text-sm font-bold uppercase\">Spins Used</p>\n                            <p className=\"text-3xl font-black text-slate-900 mt-2\">{spinsUsed}</p>\n                        </div>\n                        <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                            <p className=\"text-slate-500 text-sm font-bold uppercase\">Redemptions</p>\n                            <p className=\"text-3xl font-black text-slate-900 mt-2\">{couponsRedeemed}</p>\n                        </div>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                         <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                             <h3 className=\"font-bold text-slate-900 mb-4\">Recent Activity</h3>\n                             <div className=\"space-y-4\">\n                                 {logs.slice(0, 5).map(log => (\n                                     <div key={log.id} className=\"flex items-start gap-3 text-sm\">\n                                         <span className=\"text-slate-400 font-mono text-xs mt-0.5\">{log.timestamp.split(' ')[1]}</span>\n                                         <div>\n                                             <p className=\"font-medium text-slate-900\">{log.action}: {log.details}</p>\n                                             <p className=\"text-slate-500 text-xs\">by {log.userName}</p>\n                                         </div>\n                                     </div>\n                                 ))}\n                             </div>\n                         </div>\n                         <div className=\"bg-white p-6 rounded-xl border border-slate-200 shadow-sm\">\n                            <h3 className=\"font-bold text-slate-900 mb-4\">Risk Monitor</h3>\n                            <div className=\"flex items-center gap-4 mb-4\">\n                                <div className=\"size-16 rounded-full border-4 border-green-500 flex items-center justify-center\">\n                                    <span className=\"font-bold text-green-700\">Low</span>\n                                </div>\n                                <div>\n                                    <p className=\"text-sm text-slate-500\">Current Payout Rate</p>\n                                    <p className=\"text-xl font-bold\">12.5%</p>\n                                </div>\n                            </div>\n                            <p className=\"text-xs text-slate-500\">Based on value of redeemed coupons vs bill total.</p>\n                         </div>\n                    </div>\n                </div>\n            )}\n\n            {/* --- PRIZES VIEW --- */}\n            {activeTab === 'prizes' && (\n                <div className=\"max-w-6xl mx-auto space-y-6\">\n                    {/* Risk Indicator */}\n                    <div className=\"bg-orange-50 border border-orange-200 rounded-xl p-4 flex gap-4\">\n                        <div className=\"p-2 bg-orange-100 rounded-full text-orange-600 h-fit\">\n                            <span className=\"material-symbols-outlined\">warning</span>\n                        </div>\n                        <div>\n                            <h3 className=\"font-bold text-orange-900 text-sm\">Daily Risk Indicator</h3>\n                            <p className=\"text-xs text-orange-800 mt-1\">High concentration of winners on <span className=\"font-bold\">10% Off</span> (76.9%).</p>\n                            <div className=\"w-48 h-1.5 bg-orange-200 rounded-full mt-2 overflow-hidden\">\n                                <div className=\"bg-orange-500 w-[75%] h-full\"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Table */}\n                    <div className=\"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden\">\n                        <div className=\"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50\">\n                            <h3 className=\"font-bold text-slate-800\">Prize Items</h3>\n                            <button className=\"text-sm text-blue-600 font-bold hover:underline\">+ Add Prize</button>\n                        </div>\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"w-full text-left text-sm\">\n                                <thead className=\"bg-slate-50 text-slate-500 font-medium border-b border-slate-200\">\n                                    <tr>\n                                        <th className=\"px-6 py-3\">Prize Name</th>\n                                        <th className=\"px-6 py-3 text-center\">Weight</th>\n                                        <th className=\"px-6 py-3 text-center\">Total Avail</th>\n                                        <th className=\"px-6 py-3\">Win Limit</th>\n                                        <th className=\"px-6 py-3 text-center\">Status</th>\n                                        <th className=\"px-6 py-3 text-right\">Actions</th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"divide-y divide-slate-100\">\n                                    {prizes.map((prize) => (\n                                        <tr key={prize.id} className=\"hover:bg-slate-50 transition-colors group\">\n                                            <td className=\"px-6 py-4 font-medium text-slate-900 flex items-center gap-2\">\n                                                <span className=\"material-symbols-outlined text-slate-400\">{prize.icon}</span>\n                                                {prize.name}\n                                            </td>\n                                            <td className=\"px-6 py-4\">\n                                                <div className=\"flex items-center justify-center gap-2\">\n                                                    <input type=\"number\" className=\"w-16 px-2 py-1 border border-slate-300 rounded text-center\" defaultValue={prize.weight} />\n                                                </div>\n                                            </td>\n                                            <td className=\"px-6 py-4 text-center\">\n                                                <span className=\"px-2 py-1 bg-slate-100 rounded text-xs font-mono\">{prize.totalAvailable}</span>\n                                            </td>\n                                            <td className=\"px-6 py-4 text-slate-600\">{prize.winLimit}</td>\n                                            <td className=\"px-6 py-4 text-center\">\n                                                 <div className={`inline-block w-3 h-3 rounded-full ${prize.active ? 'bg-green-500' : 'bg-slate-300'}`}></div>\n                                            </td>\n                                            <td className=\"px-6 py-4 text-right\">\n                                                <button className=\"text-slate-400 hover:text-blue-600\">\n                                                    <span className=\"material-symbols-outlined text-[20px]\">edit</span>\n                                                </button>\n                                            </td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* --- LOGS VIEW --- */}\n            {activeTab === 'logs' && (\n                <div className=\"max-w-[1200px] mx-auto space-y-6\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-end justify-between gap-4\">\n                        <div className=\"flex flex-col gap-1\">\n                            <h2 className=\"text-3xl font-black text-slate-900 tracking-tight\">Activity Logs</h2>\n                            <p className=\"text-slate-500 text-base max-w-2xl\">Audit trail for spins, redemptions, and administrative grants.</p>\n                        </div>\n                        <button className=\"flex items-center gap-2 h-10 px-4 bg-white border border-slate-200 text-slate-900 text-sm font-semibold rounded-lg hover:bg-slate-50 transition-colors shadow-sm\">\n                            <span className=\"material-symbols-outlined text-lg\">download</span>\n                            <span>Export CSV</span>\n                        </button>\n                    </div>\n\n                    <div className=\"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden\">\n                        {/* Summary Tabs */}\n                        <div className=\"border-b border-slate-200 px-6\">\n                            <div className=\"flex gap-8 overflow-x-auto\">\n                                <button \n                                    onClick={() => setActiveLogType('SPIN')}\n                                    className={`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${activeLogType === 'SPIN' ? 'text-blue-600 border-blue-600' : 'text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200'}`}\n                                >\n                                    <span>Spin Log</span>\n                                </button>\n                                <button \n                                    onClick={() => setActiveLogType('REDEMPTION')}\n                                    className={`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${activeLogType === 'REDEMPTION' ? 'text-blue-600 border-blue-600' : 'text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200'}`}\n                                >\n                                    <span>Redeems</span>\n                                </button>\n                                <button \n                                    onClick={() => setActiveLogType('EARN_POINTS')}\n                                    className={`relative py-4 text-sm font-bold border-b-[2px] flex items-center gap-2 transition-colors whitespace-nowrap ${activeLogType === 'EARN_POINTS' ? 'text-blue-600 border-blue-600' : 'text-slate-500 border-transparent hover:text-slate-900 hover:border-slate-200'}`}\n                                >\n                                    <span>Points Earned</span>\n                                </button>\n                            </div>\n                        </div>\n\n                        <table className=\"w-full text-left text-sm\">\n                            <thead className=\"bg-slate-50 text-slate-500 font-medium border-b border-slate-200\">\n                                <tr>\n                                    <th className=\"py-3 px-6 text-xs font-semibold uppercase tracking-wider\">Timestamp</th>\n                                    <th className=\"py-3 px-6 text-xs font-semibold uppercase tracking-wider\">User</th>\n                                    <th className=\"py-3 px-6 text-xs font-semibold uppercase tracking-wider\">Details</th>\n                                    <th className=\"py-3 px-6 text-xs font-semibold uppercase tracking-wider text-right\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-slate-100\">\n                                {logs.filter(l => l.action === activeLogType || (activeLogType === 'EARN_POINTS' && (l.action === 'EARN_POINTS' || l.action === 'CONVERT_POINTS'))).map((log) => (\n                                    <tr key={log.id} className=\"hover:bg-slate-50 transition-colors group cursor-pointer\">\n                                        <td className=\"py-4 px-6 text-slate-500\">\n                                            <div className=\"flex flex-col\">\n                                                <span className=\"text-sm font-medium text-slate-900\">{log.timestamp.split(',')[0]}</span>\n                                                <span className=\"text-xs text-slate-400\">{log.timestamp.split(',')[1] || ''}</span>\n                                            </div>\n                                        </td>\n                                        <td className=\"py-4 px-6\">\n                                            <div className=\"flex items-center gap-3\">\n                                                <img src={log.userAvatar} className=\"size-8 rounded-full\" alt=\"\" />\n                                                <div className=\"flex flex-col\">\n                                                    <span className=\"text-sm font-medium text-slate-900 group-hover:text-blue-600 transition-colors\">{log.userName}</span>\n                                                    <span className=\"text-xs text-slate-400\">user_{log.userId}</span>\n                                                </div>\n                                            </div>\n                                        </td>\n                                        <td className=\"py-4 px-6\">\n                                            {renderActionBadge(log.action, log.details)}\n                                        </td>\n                                        <td className=\"py-4 px-6 text-right\">\n                                            <button className=\"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors inline-block\">\n                                                <span className=\"material-symbols-outlined text-lg align-middle\">visibility</span>\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            )}\n        </div>\n      </main>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4306, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/components/auth/LoginScreen.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { supabase } from '../../services/supabase';\n\nexport const LoginScreen = () => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleLogin = async (provider: 'google' | 'apple') => {\n    setLoading(true);\n    setError(null);\n    try {\n      const { error } = await supabase.auth.signInWithOAuth({\n        provider,\n        options: {\n          redirectTo: window.location.origin, // Redirect back to root (App.tsx handles routing)\n        },\n      });\n      if (error) throw error;\n    } catch (err: any) {\n      setError(err.message || 'Login failed');\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-ocean-950 flex flex-col items-center justify-center p-6 relative overflow-hidden\">\n      {/* Ambient Background */}\n      <div className=\"absolute top-[-20%] left-[-20%] w-[600px] h-[600px] bg-blue-600/20 rounded-full blur-[120px] pointer-events-none\" />\n      <div className=\"absolute bottom-[-20%] right-[-20%] w-[500px] h-[500px] bg-gold-400/10 rounded-full blur-[100px] pointer-events-none\" />\n\n      <div className=\"w-full max-w-sm z-10 animate-in fade-in zoom-in duration-500\">\n        <div className=\"text-center mb-10\">\n          <div className=\"size-20 bg-ocean-900 border-2 border-gold-400 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl shadow-gold-400/20\">\n            <span className=\"material-symbols-outlined text-4xl text-gold-400\">water_drop</span>\n          </div>\n          <h1 className=\"text-3xl font-black text-white mb-2 tracking-tight\">Ocean Sumria</h1>\n          <p className=\"text-slate-400\">Rewards & Loyalty Program</p>\n        </div>\n\n        <div className=\"space-y-4\">\n          <button\n            onClick={() => handleLogin('google')}\n            disabled={loading}\n            className=\"w-full bg-white hover:bg-slate-50 text-slate-900 font-bold py-3.5 px-4 rounded-xl flex items-center justify-center gap-3 transition-transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-wait\"\n          >\n            <img src=\"https://www.svgrepo.com/show/475656/google-color.svg\" className=\"w-5 h-5\" alt=\"Google\" />\n            Continue with Google\n          </button>\n\n          <button\n            onClick={() => handleLogin('apple')}\n            disabled={loading}\n            className=\"w-full bg-black hover:bg-slate-900 text-white font-bold py-3.5 px-4 rounded-xl flex items-center justify-center gap-3 transition-transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-wait border border-white/10\"\n          >\n            <span className=\"material-symbols-outlined text-[20px]\">apple</span>\n            Continue with Apple\n          </button>\n        </div>\n\n        {error && (\n            <div className=\"mt-6 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center\">\n                {error}\n            </div>\n        )}\n\n        <div className=\"mt-12 text-center\">\n          <p className=\"text-xs text-slate-500\">\n            By continuing, you agree to our <a href=\"#\" className=\"underline hover:text-slate-400\">Terms</a> and <a href=\"#\" className=\"underline hover:text-slate-400\">Privacy Policy</a>.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AAEO,MAAM,cAAc;;IACzB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,cAAc,OAAO;QACzB,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,mIAAQ,CAAC,IAAI,CAAC,eAAe,CAAC;gBACpD;gBACA,SAAS;oBACP,YAAY,OAAO,QAAQ,CAAC,MAAM;gBACpC;YACF;YACA,IAAI,OAAO,MAAM;QACnB,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO,IAAI;YACxB,WAAW;QACb;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BAEf,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAK,WAAU;8CAAmD;;;;;;;;;;;0CAErE,6LAAC;gCAAG,WAAU;0CAAqD;;;;;;0CACnE,6LAAC;gCAAE,WAAU;0CAAiB;;;;;;;;;;;;kCAGhC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,SAAS,IAAM,YAAY;gCAC3B,UAAU;gCACV,WAAU;;kDAEV,6LAAC;wCAAI,KAAI;wCAAuD,WAAU;wCAAU,KAAI;;;;;;oCAAW;;;;;;;0CAIrG,6LAAC;gCACC,SAAS,IAAM,YAAY;gCAC3B,UAAU;gCACV,WAAU;;kDAEV,6LAAC;wCAAK,WAAU;kDAAwC;;;;;;oCAAY;;;;;;;;;;;;;oBAKvE,uBACG,6LAAC;wBAAI,WAAU;kCACV;;;;;;kCAIT,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAE,WAAU;;gCAAyB;8CACJ,6LAAC;oCAAE,MAAK;oCAAI,WAAU;8CAAiC;;;;;;gCAAS;8CAAK,6LAAC;oCAAE,MAAK;oCAAI,WAAU;8CAAiC;;;;;;gCAAkB;;;;;;;;;;;;;;;;;;;;;;;;AAM1L;GAtEa;KAAA"}},
    {"offset": {"line": 4516, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yesod/Desktop/ocean-sumria-rewards/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { CustomerApp } from './components/customer/CustomerApp';\nimport { StaffApp } from './components/staff/StaffApp';\nimport { AdminApp } from './components/admin/AdminApp';\nimport { LoginScreen } from './components/auth/LoginScreen';\nimport { UserRole } from './types';\nimport { AppProvider, useAppStore } from './services/store';\n\nfunction AppRouter() {\n  const { state, actions } = useAppStore();\n  const [customerView, setCustomerView] = useState('home');\n\n  // --- Virtual Router Logic ---\n  // Syncs window URL with active role for \"Routing\" feel without a router lib\n  useEffect(() => {\n      if (!state.currentUser) {\n          window.history.replaceState(null, '', '/login');\n          return;\n      }\n      \n      const role = state.currentUser.role;\n      let path = '/';\n      if (role === UserRole.STAFF) path = '/staff';\n      if (role === UserRole.ADMIN) path = '/admin';\n      \n      if (window.location.pathname !== path) {\n          window.history.pushState(null, '', path);\n      }\n  }, [state.currentUser]);\n\n\n  if (state.isLoading) {\n      return (\n          <div className=\"min-h-screen bg-ocean-950 flex items-center justify-center\">\n              <div className=\"size-12 border-4 border-gold-400 border-t-transparent rounded-full animate-spin\"></div>\n          </div>\n      );\n  }\n\n  if (!state.currentUser) {\n      return <LoginScreen />;\n  }\n\n  // --- Handlers ---\n\n  const handleSpin = async () => {\n     if (state.currentUser?.role === UserRole.CUSTOMER) {\n         return await actions.spinWheel(state.currentUser.id);\n     }\n     return { ok: false, error: \"Invalid role\" };\n  };\n\n  const handleGrant = (customerId: string, billAmount: number) => {\n     if (state.currentUser?.role === UserRole.STAFF) {\n        // The mock logic for lookup relies on the store knowing the 'users' map\n        // Since we moved to API-based, we pass the customerPublicId directly to the action\n        // The StaffApp component already resolves the ID to a user object via lookup (if implemented)\n        // OR simply passes the ID.\n        // For this architecture, we pass the public ID.\n        return actions.grantSpinsByPublicId(state.currentUser.id, customerId, billAmount);\n     }\n     return Promise.resolve({ success: false, message: \"Unauthorized\" });\n  };\n\n  const handleRedeem = (code: string) => {\n     if (state.currentUser?.role === UserRole.STAFF) {\n        // Wrap promise to boolean for legacy component prop compatibility if needed\n        // but ideally update component to await.\n        // We will assume component can handle promise or we sync it here.\n        // For simplicity, we just trigger action.\n        return actions.redeemCoupon(state.currentUser.id, code).then(res => res);\n     }\n     return false; // Sync return default\n  };\n\n  // --- Render ---\n\n  switch (state.currentUser.role) {\n    case UserRole.CUSTOMER:\n      return (\n          <CustomerApp \n              user={state.currentUser} \n              rewards={state.rewards}\n              onNavigate={setCustomerView}\n              currentView={customerView}\n              onSpin={handleSpin}\n          />\n      );\n    case UserRole.STAFF:\n      return (\n          <StaffApp \n              user={state.currentUser} \n              onGrantSpins={(id, amt) => {\n                  // Adapter: Component expects sync return, action is async.\n                  // We return a loading placeholder object, the component will receive toast via store?\n                  // Actually StaffApp expects immediate return object.\n                  // We can't await here easily without refactoring StaffApp.\n                  // HACK: We execute the async action, but return a \"Processing...\" success state.\n                  // Real implementation should refactor StaffApp to await.\n                  actions.grantSpinsByPublicId(state.currentUser!.id, id, amt);\n                  return { success: true, message: \"Processing transaction...\" };\n              }}\n              onRedeemCoupon={(code) => {\n                  actions.redeemCoupon(state.currentUser!.id, code);\n                  return true; // Optimistic\n              }}\n          />\n      );\n    case UserRole.ADMIN:\n      return <AdminApp user={state.currentUser} prizes={state.prizes} logs={state.logs} rewards={state.rewards} />;\n    default:\n      return <div>Unknown Role</div>;\n  }\n}\n\nexport default function App() {\n  return (\n    <AppProvider>\n      <AppRouter />\n    </AppProvider>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAEA,SAAS;;IACP,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,IAAA,oIAAW;IACtC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,+BAA+B;IAC/B,4EAA4E;IAC5E,IAAA,0KAAS;+BAAC;YACN,IAAI,CAAC,MAAM,WAAW,EAAE;gBACpB,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,IAAI;gBACtC;YACJ;YAEA,MAAM,OAAO,MAAM,WAAW,CAAC,IAAI;YACnC,IAAI,OAAO;YACX,IAAI,SAAS,oHAAQ,CAAC,KAAK,EAAE,OAAO;YACpC,IAAI,SAAS,oHAAQ,CAAC,KAAK,EAAE,OAAO;YAEpC,IAAI,OAAO,QAAQ,CAAC,QAAQ,KAAK,MAAM;gBACnC,OAAO,OAAO,CAAC,SAAS,CAAC,MAAM,IAAI;YACvC;QACJ;8BAAG;QAAC,MAAM,WAAW;KAAC;IAGtB,IAAI,MAAM,SAAS,EAAE;QACjB,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;IAG3B;IAEA,IAAI,CAAC,MAAM,WAAW,EAAE;QACpB,qBAAO,6LAAC,oJAAW;;;;;IACvB;IAEA,mBAAmB;IAEnB,MAAM,aAAa;QAChB,IAAI,MAAM,WAAW,EAAE,SAAS,oHAAQ,CAAC,QAAQ,EAAE;YAC/C,OAAO,MAAM,QAAQ,SAAS,CAAC,MAAM,WAAW,CAAC,EAAE;QACvD;QACA,OAAO;YAAE,IAAI;YAAO,OAAO;QAAe;IAC7C;IAEA,MAAM,cAAc,CAAC,YAAoB;QACtC,IAAI,MAAM,WAAW,EAAE,SAAS,oHAAQ,CAAC,KAAK,EAAE;YAC7C,wEAAwE;YACxE,mFAAmF;YACnF,8FAA8F;YAC9F,2BAA2B;YAC3B,gDAAgD;YAChD,OAAO,QAAQ,oBAAoB,CAAC,MAAM,WAAW,CAAC,EAAE,EAAE,YAAY;QACzE;QACA,OAAO,QAAQ,OAAO,CAAC;YAAE,SAAS;YAAO,SAAS;QAAe;IACpE;IAEA,MAAM,eAAe,CAAC;QACnB,IAAI,MAAM,WAAW,EAAE,SAAS,oHAAQ,CAAC,KAAK,EAAE;YAC7C,4EAA4E;YAC5E,yCAAyC;YACzC,kEAAkE;YAClE,0CAA0C;YAC1C,OAAO,QAAQ,YAAY,CAAC,MAAM,WAAW,CAAC,EAAE,EAAE,MAAM,IAAI,CAAC,CAAA,MAAO;QACvE;QACA,OAAO,OAAO,sBAAsB;IACvC;IAEA,iBAAiB;IAEjB,OAAQ,MAAM,WAAW,CAAC,IAAI;QAC5B,KAAK,oHAAQ,CAAC,QAAQ;YACpB,qBACI,6LAAC,wJAAW;gBACR,MAAM,MAAM,WAAW;gBACvB,SAAS,MAAM,OAAO;gBACtB,YAAY;gBACZ,aAAa;gBACb,QAAQ;;;;;;QAGlB,KAAK,oHAAQ,CAAC,KAAK;YACjB,qBACI,6LAAC,+IAAQ;gBACL,MAAM,MAAM,WAAW;gBACvB,cAAc,CAAC,IAAI;oBACf,2DAA2D;oBAC3D,sFAAsF;oBACtF,qDAAqD;oBACrD,2DAA2D;oBAC3D,iFAAiF;oBACjF,yDAAyD;oBACzD,QAAQ,oBAAoB,CAAC,MAAM,WAAW,CAAE,EAAE,EAAE,IAAI;oBACxD,OAAO;wBAAE,SAAS;wBAAM,SAAS;oBAA4B;gBACjE;gBACA,gBAAgB,CAAC;oBACb,QAAQ,YAAY,CAAC,MAAM,WAAW,CAAE,EAAE,EAAE;oBAC5C,OAAO,MAAM,aAAa;gBAC9B;;;;;;QAGV,KAAK,oHAAQ,CAAC,KAAK;YACjB,qBAAO,6LAAC,+IAAQ;gBAAC,MAAM,MAAM,WAAW;gBAAE,QAAQ,MAAM,MAAM;gBAAE,MAAM,MAAM,IAAI;gBAAE,SAAS,MAAM,OAAO;;;;;;QAC1G;YACE,qBAAO,6LAAC;0BAAI;;;;;;IAChB;AACF;GAzGS;;QACoB,oIAAW;;;KAD/B;AA2GM,SAAS;IACtB,qBACE,6LAAC,oIAAW;kBACV,cAAA,6LAAC;;;;;;;;;;AAGP;MANwB"}}]
}